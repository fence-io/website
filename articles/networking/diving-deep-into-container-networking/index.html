<!doctype html><html lang=en-us dir=ltr class=scroll-smooth data-default-appearance=dark data-auto-appearance=true><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=theme-color><link rel="shortcut icon" href=/website/favicon.ico><title>Diving deep into Container Networking (An Exploration of Linux Network Namespace) | Fence</title><meta property="og:url" content="https://fence-io.github.io/website/articles/networking/diving-deep-into-container-networking/">
<meta property="og:site_name" content="Fence"><meta property="og:title" content="Diving deep into Container Networking (An Exploration of Linux Network Namespace)"><meta property="og:description" content="Introduction # Container networking might seem complex and almost mystical initially, but itâ€™s actually built on basic Linux networking principles. By understanding these fundamentals, we can troubleshoot the container networking layers on a profound level. Furthermore, we might even create container networking solution from scratch for pure enjoyment.
In this article we are going to cover the foundational elements of container networking, from the underlying principles of network namespaces to the practical tools and techniques for managing container networking environments."><meta property="og:locale" content="en-us"><meta property="og:type" content="article"><meta property="article:section" content="articles"><meta property="article:published_time" content="2024-05-09T00:00:00+00:00"><meta property="article:modified_time" content="2024-07-18T12:27:17+02:00"><meta property="article:tag" content="Networking"><meta property="article:tag" content="Container"><meta property="article:tag" content="Linux"><meta property="article:tag" content="Bridge"><meta property="og:image" content="https://fence-io.github.io/website/articles/networking/diving-deep-into-container-networking/bridge.png"><meta property="og:see_also" content="https://fence-io.github.io/website/articles/networking/kubernetes-networking/"><meta property="og:see_also" content="https://fence-io.github.io/website/articles/networking/setting-up-load-balancer-service-with-cilium-in-kind-cluster/"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://fence-io.github.io/website/articles/networking/diving-deep-into-container-networking/bridge.png"><meta name=twitter:title content="Diving deep into Container Networking (An Exploration of Linux Network Namespace)"><meta name=twitter:description content="Introduction # Container networking might seem complex and almost mystical initially, but it&rsquo;s actually built on basic Linux networking principles. By understanding these fundamentals, we can troubleshoot the container networking layers on a profound level. Furthermore, we might even create container networking solution from scratch for pure enjoyment.
In this article we are going to cover the foundational elements of container networking, from the underlying principles of network namespaces to the practical tools and techniques for managing container networking environments."><meta name=twitter:site content="@FenceCommunity"><link href="/website/css/main.min.6e73234a6bba4f80a00a76e9482140f8a578b5fcedd77b62664fc516ce820a00.css" rel=stylesheet><link href="/website/css/schemes/slate.min.49077614e43328c746e214d8c7c3c820cdeadaf2eccb92e06d0aba4e2e102d4d.css" rel=stylesheet><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap" rel=stylesheet><script type=text/javascript src=/website/js/appearance.min.516a16745bea5a9bd011138d254cc0fd3973cd55ce6e15f3dec763e7c7c2c7448f8fe7b54cca811cb821b0c7e12cd161caace1dd794ac3d34d40937cbcc9ee12.js integrity="sha512-UWoWdFvqWpvQERONJUzA/TlzzVXObhXz3sdj58fCx0SPj+e1TMqBHLghsMfhLNFhyqzh3XlKw9NNQJN8vMnuEg=="></script><script defer type=text/javascript id=script-bundle src=/website/js/main.bundle.min.b36dda9ec4ec11e967fd341e7d57b8c484ac7a39f8f329f7bcf7ce4812569de8607db866a086d4789956ac0b74967e251c9a566d94d469dd28b8787fed4f46f5.js integrity="sha512-s23ansTsEeln/TQefVe4xISsejn48yn3vPfOSBJWnehgfbhmoIbUeJlWrAt0ln4lHJpWbZTUad0ouHh/7U9G9Q==" data-copy=Copy data-copied=Copied></script><script src=/website/lib/jquery/jquery.slim.min.js integrity></script><style>body{font-family:roboto}</style></head><body id=top class="relative flex flex-col bg-neutral text-neutral-900 dark:bg-neutral-900 dark:text-neutral"><div class="fixed top-0 bottom-0 left-0 right-0 animate-[fadeIn_1s_ease-in-out]" style=z-index:-1><img src=/website/img/background.svg class="w-full h-full object-cover"></div><div class="sticky top-0 bg-neutral/70 text-neutral-900 dark:bg-neutral-900/70 dark:text-neutral" style=z-index:100><div class=mx-6><div class="main-menu flex items-center justify-between"><a href=/website/ class="flex w-8 h-8 my-3 drop-shadow-[0_0_0.75rem_crimson]"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill="currentcolor" d="M12 3.75A6.715 6.715.0 008.278 4.868.75.75.0 117.45 3.618a8.25 8.25.0 0112.8 6.883c0 3.014-.574 5.897-1.62 8.543a.75.75.0 01-1.395-.551A21.69 21.69.0 0018.75 10.5 6.75 6.75.0 0012 3.75zM6.157 5.739a.75.75.0 01.21 1.04A6.715 6.715.0 005.25 10.5c0 1.613-.463 3.12-1.265 4.393a.75.75.0 01-1.27-.8A6.715 6.715.0 003.75 10.5c0-1.68.503-3.246 1.367-4.55a.75.75.0 011.04-.211zM12 7.5a3 3 0 00-3 3c0 3.1-1.176 5.927-3.105 8.056a.75.75.0 11-1.112-1.008A10.459 10.459.0 007.5 10.5a4.5 4.5.0 119 0c0 .547-.022 1.09-.067 1.626a.75.75.0 01-1.495-.123c.041-.495.062-.996.062-1.503a3 3 0 00-3-3zm0 2.25a.75.75.0 01.75.75c0 3.908-1.424 7.485-3.781 10.238a.75.75.0 01-1.14-.975A14.19 14.19.0 0011.25 10.5.75.75.0 0112 9.75zm3.239 5.183a.75.75.0 01.515.927 19.417 19.417.0 01-2.585 5.544.75.75.0 01-1.243-.84 17.915 17.915.0 002.386-5.116.75.75.0 01.927-.515z" clip-rule="evenodd"/></svg></a><nav class=flex-1><a href=/website/ class="text-xl font-bold pl-6">Fence</a></nav><nav class="hidden md:flex items-center space-x-5"><a href=/website/articles/ class="flex items-center"><p class="text-base font-medium" title>Articles</p></a><a href=/website/podcasts/ class="flex items-center"><p class="text-base font-medium" title>Podcasts</p></a><a href=/website/videos/ class="flex items-center"><p class="text-base font-medium" title>Videos</p></a><a href=/website/blog/ class="flex items-center"><p class="text-base font-medium" title>Blog</p></a><a href=/website/ class="flex items-center"><span><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentcolor" class="w-6 h-6"><path d="M11.47 3.841a.75.75.0 011.06.0l8.69 8.69a.75.75.0 101.06-1.061l-8.689-8.69a2.25 2.25.0 00-3.182.0l-8.69 8.69a.75.75.0 101.061 1.06l8.69-8.689z"/><path d="m12 5.432 8.159 8.159c.03.03.06.058.091.086v6.198c0 1.035-.84 1.875-1.875 1.875H15a.75.75.0 01-.75-.75v-4.5a.75.75.0 00-.75-.75h-3a.75.75.0 00-.75.75V21a.75.75.0 01-.75.75H5.625A1.875 1.875.0 013.75 19.875v-6.198a2.29 2.29.0 00.091-.086L12 5.432z"/></svg></span></span><p class="text-base font-medium" title></p></a><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentcolor" class="w-6 h-6"><path fill-rule="evenodd" d="M10.5 6a1.5 1.5.0 113 0 1.5 1.5.0 01-3 0zm0 6a1.5 1.5.0 113 0 1.5 1.5.0 01-3 0zm0 6a1.5 1.5.0 113 0 1.5 1.5.0 01-3 0z" clip-rule="evenodd"/></svg>
</span><a href=https://github.com/fence-io/website class="flex items-center" target=_blank><span><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentcolor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6.0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6.0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3.0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1.0-6.2-.3-40.4-.3-61.4.0.0-70 15-84.7-29.8.0.0-11.4-29.1-27.8-36.6.0.0-22.9-15.7 1.6-15.4.0.0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5.0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9.0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4.0 33.7-.3 75.4-.3 83.6.0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6.0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9.0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg></span></span><p class="text-base font-medium" title></p></a><a href=https://twitter.com/FenceCommunity class="flex items-center" target=_blank><span><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8L200.7 275.5 26.8 48H172.4L272.9 180.9 389.2 48zM364.4 421.8h39.1L151.1 88h-42L364.4 421.8z"/></svg></span></span><p class="text-base font-medium" title></p></a><a href=https://fence-io.slack.com class="flex items-center" target=_blank><span><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentcolor" d="M94.12 315.1c0 25.9-21.16 47.06-47.06 47.06S0 341 0 315.1s21.16-47.06 47.06-47.06h47.06v47.06zm23.72.0c0-25.9 21.16-47.06 47.06-47.06s47.06 21.16 47.06 47.06v117.84c0 25.9-21.16 47.06-47.06 47.06s-47.06-21.16-47.06-47.06V315.1zm47.06-188.98c-25.9.0-47.06-21.16-47.06-47.06S139 32 164.9 32s47.06 21.16 47.06 47.06v47.06H164.9zm0 23.72c25.9.0 47.06 21.16 47.06 47.06s-21.16 47.06-47.06 47.06H47.06C21.16 243.96.0 222.8.0 196.9s21.16-47.06 47.06-47.06H164.9zm188.98 47.06c0-25.9 21.16-47.06 47.06-47.06S448 171 448 196.9s-21.16 47.06-47.06 47.06h-47.06V196.9zm-23.72.0c0 25.9-21.16 47.06-47.06 47.06s-47.06-21.16-47.06-47.06V79.06c0-25.9 21.16-47.06 47.06-47.06s47.06 21.16 47.06 47.06V196.9zM283.1 385.88c25.9.0 47.06 21.16 47.06 47.06S309 480 283.1 480s-47.06-21.16-47.06-47.06v-47.06h47.06zm0-23.72c-25.9.0-47.06-21.16-47.06-47.06s21.16-47.06 47.06-47.06h117.84c25.9.0 47.06 21.16 47.06 47.06s-21.16 47.06-47.06 47.06H283.1z"/></svg></span></span><p class="text-base font-medium" title></p></a><a href=https://www.linkedin.com/groups/13033088/ class="flex items-center" target=_blank><span><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentcolor" d="M416 32H31.9C14.3 32 0 46.5.0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6.0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3.0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2.0 38.5 17.3 38.5 38.5.0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6.0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2.0 79.7 44.3 79.7 101.9V416z"/></svg></span></span><p class="text-base font-medium" title></p></a><a href=https://todo class="flex items-center" target=_blank><span><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><path fill="currentcolor" d="M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78.0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305zm-317.51 213.508V175.185l142.739 81.205-142.739 81.201z"/></svg></span></span><p class="text-base font-medium" title></p></a><a href=https://groups.google.com/g/fence-community class="flex items-center" target=_blank><span><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 488 512"><path fill="currentcolor" d="M488 261.8C488 403.3 391.1 504 248 504 110.8 504 0 393.2.0 256S110.8 8 248 8c66.8.0 123 24.5 166.3 64.9l-67.5 64.9C258.5 52.6 94.3 116.6 94.3 256c0 86.5 69.1 156.6 153.7 156.6 98.2.0 135-70.4 140.8-106.9H248v-85.3h236.1c2.3 12.7 3.9 24.9 3.9 41.4z"/></svg></span></span><p class="text-base font-medium" title></p></a><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentcolor" class="w-6 h-6"><path fill-rule="evenodd" d="M10.5 6a1.5 1.5.0 113 0 1.5 1.5.0 01-3 0zm0 6a1.5 1.5.0 113 0 1.5 1.5.0 01-3 0zm0 6a1.5 1.5.0 113 0 1.5 1.5.0 01-3 0z" clip-rule="evenodd"/></svg>
</span><button id=search-button aria-label=Search class="text-base hover:text-primary-600 dark:hover:text-primary-400" title="Search (/)">
<span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg></span></button><div class="flex items-center"><button id=appearance-switcher aria-label="Dark mode switcher" type=button class="text-base hover:text-primary-600 dark:hover:text-primary-400"><div class="flex items-center justify-center dark:hidden"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentcolor" class="w-6 h-6"><path fill-rule="evenodd" d="M9.528 1.718a.75.75.0 01.162.819A8.97 8.97.0 009 6a9 9 0 009 9 8.97 8.97.0 003.463-.69.75.75.0 01.981.98 10.503 10.503.0 01-9.694 6.46c-5.799.0-10.5-4.7-10.5-10.5.0-4.368 2.667-8.112 6.46-9.694a.75.75.0 01.818.162z" clip-rule="evenodd"/></svg></span></div><div class="items-center justify-center hidden dark:flex"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentcolor" class="w-6 h-6"><path d="M12 2.25a.75.75.0 01.75.75v2.25a.75.75.0 01-1.5.0V3a.75.75.0 01.75-.75zM7.5 12a4.5 4.5.0 119 0 4.5 4.5.0 01-9 0zM18.894 6.166a.75.75.0 00-1.06-1.06l-1.591 1.59a.75.75.0 101.06 1.061l1.591-1.59zM21.75 12a.75.75.0 01-.75.75h-2.25a.75.75.0 010-1.5H21a.75.75.0 01.75.75zm-3.916 6.894a.75.75.0 001.06-1.06l-1.59-1.591a.75.75.0 10-1.061 1.06l1.59 1.591zM12 18a.75.75.0 01.75.75V21a.75.75.0 01-1.5.0v-2.25A.75.75.0 0112 18zM7.758 17.303a.75.75.0 00-1.061-1.06l-1.591 1.59a.75.75.0 001.06 1.061l1.591-1.59zM6 12a.75.75.0 01-.75.75H3a.75.75.0 010-1.5h2.25A.75.75.0 016 12zm.697-4.243a.75.75.0 001.06-1.06l-1.59-1.591a.75.75.0 00-1.061 1.06l1.59 1.591z"/></svg></span></div></button></div></nav></div><nav class="main-menu flex md:hidden items-center justify-between space-x-2"><a href=/website/articles/ class="flex items-center"><p class="text-base font-medium" title>Articles</p></a><a href=/website/podcasts/ class="flex items-center"><p class="text-base font-medium" title>Podcasts</p></a><a href=/website/videos/ class="flex items-center"><p class="text-base font-medium" title>Videos</p></a><a href=/website/blog/ class="flex items-center"><p class="text-base font-medium" title>Blog</p></a><a href=/website/ class="flex items-center"><span><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentcolor" class="w-6 h-6"><path d="M11.47 3.841a.75.75.0 011.06.0l8.69 8.69a.75.75.0 101.06-1.061l-8.689-8.69a2.25 2.25.0 00-3.182.0l-8.69 8.69a.75.75.0 101.061 1.06l8.69-8.689z"/><path d="m12 5.432 8.159 8.159c.03.03.06.058.091.086v6.198c0 1.035-.84 1.875-1.875 1.875H15a.75.75.0 01-.75-.75v-4.5a.75.75.0 00-.75-.75h-3a.75.75.0 00-.75.75V21a.75.75.0 01-.75.75H5.625A1.875 1.875.0 013.75 19.875v-6.198a2.29 2.29.0 00.091-.086L12 5.432z"/></svg></span></span><p class="text-base font-medium" title></p></a><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentcolor" class="w-6 h-6"><path fill-rule="evenodd" d="M10.5 6a1.5 1.5.0 113 0 1.5 1.5.0 01-3 0zm0 6a1.5 1.5.0 113 0 1.5 1.5.0 01-3 0zm0 6a1.5 1.5.0 113 0 1.5 1.5.0 01-3 0z" clip-rule="evenodd"/></svg>
</span><button id=search-button aria-label=Search class="text-base hover:text-primary-600 dark:hover:text-primary-400" title="Search (/)">
<span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg></span></button><div class="flex items-center"><button id=appearance-switcher-mobile aria-label="Dark mode switcher" type=button class="text-base hover:text-primary-600 dark:hover:text-primary-400"><div class="flex items-center justify-center dark:hidden"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentcolor" class="w-6 h-6"><path fill-rule="evenodd" d="M9.528 1.718a.75.75.0 01.162.819A8.97 8.97.0 009 6a9 9 0 009 9 8.97 8.97.0 003.463-.69.75.75.0 01.981.98 10.503 10.503.0 01-9.694 6.46c-5.799.0-10.5-4.7-10.5-10.5.0-4.368 2.667-8.112 6.46-9.694a.75.75.0 01.818.162z" clip-rule="evenodd"/></svg></span></div><div class="items-center justify-center hidden dark:flex"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentcolor" class="w-6 h-6"><path d="M12 2.25a.75.75.0 01.75.75v2.25a.75.75.0 01-1.5.0V3a.75.75.0 01.75-.75zM7.5 12a4.5 4.5.0 119 0 4.5 4.5.0 01-9 0zM18.894 6.166a.75.75.0 00-1.06-1.06l-1.591 1.59a.75.75.0 101.06 1.061l1.591-1.59zM21.75 12a.75.75.0 01-.75.75h-2.25a.75.75.0 010-1.5H21a.75.75.0 01.75.75zm-3.916 6.894a.75.75.0 001.06-1.06l-1.59-1.591a.75.75.0 10-1.061 1.06l1.59 1.591zM12 18a.75.75.0 01.75.75V21a.75.75.0 01-1.5.0v-2.25A.75.75.0 0112 18zM7.758 17.303a.75.75.0 00-1.061-1.06l-1.591 1.59a.75.75.0 001.06 1.061l1.591-1.59zM6 12a.75.75.0 01-.75.75H3a.75.75.0 010-1.5h2.25A.75.75.0 016 12zm.697-4.243a.75.75.0 001.06-1.06l-1.59-1.591a.75.75.0 00-1.061 1.06l1.59 1.591z"/></svg></span></div></button></div></nav><script>(function(){var e=$(".main-menu");e.find(`a[href="${window.location.pathname}"]`).each(function(e,t){$(t).children("p").addClass("active")})})()</script></div></div><main id=main-content class=min-h-[calc(100vh-7rem)]><div class="bg-neutral-900 text-neutral-200 min-h-[inherit]"><div class="grid grid-cols-2 md:grid-cols-4"><div class="hidden md:block mx-8"><div class="flex flex-col sticky top-[8.4rem]"><div class="toc print:hidden"><details open><summary class="block py-1 text-lg font-semibold cursor-pointer text-neutral-100">Networking</summary><div class="border-dotted border-l pl-5 border-neutral-600"><a href=https://fence-io.github.io/website/articles/networking/setting-up-load-balancer-service-with-cilium-in-kind-cluster/>Part 1: Setting up Load Balancer Service with Cilium in KinD Cluster</a></div><div class="border-dotted border-l pl-5 border-neutral-600">Part 2: This Article</div><div class="border-dotted border-l pl-5 border-neutral-600"><a href=https://fence-io.github.io/website/articles/networking/kubernetes-networking/>Part 3: Decoding Kubernetes Pod Creation and Network Traffic Management</a></div></details></div></div></div><div class="col-span-2 prose prose-invert py-20 max-w-fit"><h1 class=font-normal>Diving deep into Container Networking (An Exploration of Linux Network Namespace)</h1><div class="text-sm mb-6"><div class="flex flex-row flex-wrap items-center"></div><div class="flex flex-row flex-wrap items-center"><time datetime="2024-05-09 00:00:00 +0000 UTC">May 9, 2024</time><span class="px-2 text-primary-500">&#183;</span><time datetime="2024-07-18 12:27:17 +0200 +0200">Updated: July 18, 2024</time><span class="px-2 text-primary-500">&#183;</span><span>4379 words</span><span class="px-2 text-primary-500">&#183;</span><span title>21 mins</span><span class="px-2 text-primary-500">&#183;</span>
<span class=mb-[2px]><a href=https://github.com/fence-io/website/tree/main/content/articles/networking/linux-network-namespace/index.md class="text-lg hover:text-primary-500" rel="noopener noreferrer" target=_blank title="Edit content"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 512 512"><path fill="currentcolor" d="M441 58.9 453.1 71c9.4 9.4 9.4 24.6.0 33.9L424 134.1 377.9 88 407 58.9c9.4-9.4 24.6-9.4 33.9.0zM209.8 256.2 344 121.9 390.1 168 255.8 302.2c-2.9 2.9-6.5 5-10.4 6.1L186.9 325l16.7-58.5c1.1-3.9 3.2-7.5 6.1-10.4zM373.1 25 175.8 222.2c-8.7 8.7-15 19.4-18.3 31.1l-28.6 1e2c-2.4 8.4-.1 17.4 6.1 23.6s15.2 8.5 23.6 6.1l1e2-28.6c11.8-3.4 22.5-9.7 31.1-18.3L487 138.9c28.1-28.1 28.1-73.7.0-101.8L474.9 25C446.8-3.1 401.2-3.1 373.1 25zM88 64C39.4 64 0 103.4.0 152V424c0 48.6 39.4 88 88 88H360c48.6.0 88-39.4 88-88V312c0-13.3-10.7-24-24-24s-24 10.7-24 24V424c0 22.1-17.9 40-40 40H88c-22.1.0-40-17.9-40-40V152c0-22.1 17.9-40 40-40H2e2c13.3.0 24-10.7 24-24s-10.7-24-24-24H88z"/></svg>
</span></span></a></span><span class="px-2 text-primary-500">&#183;</span>
<span style=cursor:pointer>By &nbsp;
<span style=margin-top:.5rem class="mr-2 border-cyan-300" onclick='window.open("/website/authors/sara/","_self")'>Sara Qasmi</span></span></div><div class="flex flex-row flex-wrap items-center"><span style=margin-top:.5rem class=mr-2 onclick='window.open("/website/tags/networking/","_self")'><span class=flex style=cursor:pointer><span class="rounded-md border px-1 py-[1px] text-xs font-normal">Networking
</span></span></span><span style=margin-top:.5rem class=mr-2 onclick='window.open("/website/tags/container/","_self")'><span class=flex style=cursor:pointer><span class="rounded-md border px-1 py-[1px] text-xs font-normal">Container
</span></span></span><span style=margin-top:.5rem class=mr-2 onclick='window.open("/website/tags/linux/","_self")'><span class=flex style=cursor:pointer><span class="rounded-md border px-1 py-[1px] text-xs font-normal">Linux
</span></span></span><span style=margin-top:.5rem class=mr-2 onclick='window.open("/website/tags/bridge/","_self")'><span class=flex style=cursor:pointer><span class="rounded-md border px-1 py-[1px] text-xs font-normal">Bridge</span></span></span></div></div><h1 class="relative group font-normal">Introduction<div id=introduction class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#introduction aria-label=Anchor>#</a></span></h1><p>Container networking might seem complex and almost mystical initially, but it&rsquo;s actually built on basic Linux networking principles. By understanding these fundamentals, we can troubleshoot the container networking layers on a profound level. Furthermore, we might even create container networking solution from scratch for pure enjoyment.</p><p>In this article we are going to cover the foundational elements of container networking, from the underlying principles of network namespaces to the practical tools and techniques for managing container networking environments.</p><h1 class="relative group font-normal">Requirements<div id=requirements class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#requirements aria-label=Anchor>#</a></span></h1><p>For this article, you&rsquo;ll require a Linux host system equipped with the following tools: <code>nsenter</code>, <code>ping</code>, and <code>tcpdump</code>.</p><h1 class="relative group font-normal">Dive Into The Foundations of Container Networking<div id=dive-into-the-foundations-of-container-networking class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#dive-into-the-foundations-of-container-networking aria-label=Anchor>#</a></span></h1><p>A container is essentially, an isolated and restricted Linux process within its own networking context that is completely separate from both the host system and other containers.</p><p>At the heart of this isolation lies a fascinating Linux kernel feature known as network namespaces. According to the man page, &ldquo;network namespace is logically another copy of the network stack, with its own routes, firewall rules, and network devices.&rdquo;.</p><p>Essentially, it allows processes to operate within their own distinct network environment, including having their own network interfaces, routing tables, and firewall configurations.</p><p>This capability of Linux kernel empowers containerization technologies like Docker. By placing containers within their own network namespaces, they gain autonomy over their network configurations and ensures that containers can communicate with each other or the external network without causing interference with other containers or the host system&rsquo;s network setup (root namespace).</p><p>To unravel this concept, let&rsquo;s delve into some fundamental aspects.</p><h2 class="relative group font-normal">What constitutes a Networking Stack?<div id=what-constitutes-a-networking-stack class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#what-constitutes-a-networking-stack aria-label=Anchor>#</a></span></h2><p>The networking stack is a set of software layers designed to facilitate communication across networks. Each layer within this stack is responsible for specific tasks such as data transmission, addressing, routing, and interaction with applications. Together, these layers collaborate to establish communication between devices connected to a network. This networking stack typically follows the OSI (Open Systems Interconnection) model.</p><p>Here&rsquo;s a overview of the layers commonly present in a networking stack:</p><p><img src=osi.png alt=alt></p><p>Each layer of the networking stack interacts with the layers above and below it, encapsulating data as it moves down the stack and decapsulating it as it moves up. In this article, we&rsquo;ll relay on the key components of the network stack, including:</p><ol><li><p><strong>Network Devices</strong>: Network devices, such as network interface cards (NICs), switches, and routers, are physical or virtual entities responsible for transmitting and receiving data packets on a network. These devices interface with the Linux networking stack to exchange data with other devices. You can list these devices using the command <code>ip link list</code>.</p></li><li><p><strong>Routing Table</strong>: The routing table is a critical component of the networking stack that contains information about the available routes to different network destinations. When a packet arrives at a Linux system, the networking stack consults the routing table to determine the appropriate path for forwarding the packet to its destination. Viewable with <code>ip route list</code>.</p></li><li><p><strong>iptables Rules</strong>: iptables is a powerful firewall utility in Linux that allows administrators to define rules for packet filtering and network address translation (NAT). These rules are organized into <code>chains</code> within the iptables framework.</p><p>The sequence of rules are applied to packets as they traverse the networking stack of a Linux system. These rules dictate how packets are processed, filtered, and potentially modified as they move through various stages of the networking stack.</p><p>There are three main built-in chains in iptables, each corresponding to a different stage of packet processing:</p><ul><li><strong>INPUT</strong>: Used for packets destined for the local system.</li><li><strong>FORWARD</strong>: Used for packets passing through the system.</li><li><strong>OUTPUT</strong>: Used for packets originating from the local system.</li></ul><p>When a packet reaches a chain, it is compared against the rules defined in that chain. Each rule specifies criteria that the packet must match (such as source or destination IP address, port number, protocol, etc.), as well as an action to take if the packet matches the criteria (such as accept, drop, reject, or forward to another chain).</p><p>In addition to these three built-in chains, users can also create custom chains to organize rules more efficiently or to perform specific tasks. <code>iptables --list-rules</code>.</p><p>Wait of our next article for more details on iptables.</p></li></ol><h2 class="relative group font-normal">Inspect the Network Environment<div id=inspect-the-network-environment class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#inspect-the-network-environment aria-label=Anchor>#</a></span></h2><p>Now let&rsquo;s apply what we learned before and inspect the network environment before running containers.</p><p>Network devices:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>root@ubuntu:~# ip link show 
</span></span><span style=display:flex><span>1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN mode DEFAULT group default qlen 1000
</span></span><span style=display:flex><span>    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
</span></span><span style=display:flex><span>2: enp0s1: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc fq_codel state UP mode DEFAULT group default qlen 1000
</span></span><span style=display:flex><span>    link/ether 06:c5:4b:b4:32:aa brd ff:ff:ff:ff:ff:ff
</span></span></code></pre></div><p>Routing table:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>root@ubuntu:~# ip route list 
</span></span><span style=display:flex><span>default via 192.168.64.1 dev enp0s1 proto dhcp src 192.168.64.3 metric 100 
</span></span><span style=display:flex><span>192.168.64.0/24 dev enp0s1 proto kernel scope link src 192.168.64.3 metric 100 
</span></span><span style=display:flex><span>192.168.64.1 dev enp0s1 proto dhcp scope link src 192.168.64.3 metric 100 
</span></span></code></pre></div><p>iptable rules:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>root@ubuntu:~# iptables --list-rules
</span></span><span style=display:flex><span>-P INPUT ACCEPT
</span></span><span style=display:flex><span>-P FORWARD DROP
</span></span><span style=display:flex><span>-P OUTPUT ACCEPT
</span></span><span style=display:flex><span>-N DOCKER
</span></span><span style=display:flex><span>-N DOCKER-ISOLATION-STAGE-1
</span></span><span style=display:flex><span>-N DOCKER-ISOLATION-STAGE-2
</span></span><span style=display:flex><span>-N DOCKER-USER
</span></span><span style=display:flex><span>...
</span></span></code></pre></div><p>Note: If Docker is running on your host system, you will notice some custom chains added to your iptables rules.</p><h1 class="relative group font-normal">Create A Network Namespace<div id=create-a-network-namespace class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#create-a-network-namespace aria-label=Anchor>#</a></span></h1><p>Linux offers various tools and utilities for network namespace management. The <code>ip netns</code> command facilitates the creation, deletion, and the configuration of network namespaces.</p><p>Create a new network namespace:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>root@ubuntu:~# ip netns add app1
</span></span></code></pre></div><p>To display the network namespaces that have been created, you can use the following command:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>root@ubuntu:~# ip netns list
</span></span><span style=display:flex><span>app1
</span></span></code></pre></div><p>To execute a process within a network namespace, you can utilize the <code>nsenter</code> utility. Here&rsquo;s how you can initiate a new shell within the <code>app1</code> namespace:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>root@ubuntu:~# nsenter --net=/run/netns/app1 bash
</span></span></code></pre></div><p>Now that we&rsquo;ve created a Bash process in the <code>app1</code> namespace, we can execute our commands within the network namespace.</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>root@ubuntu:~# ip link list
</span></span><span style=display:flex><span>1: lo: &lt;LOOPBACK&gt; mtu 65536 qdisc noop state DOWN mode DEFAULT group default qlen 1000
</span></span><span style=display:flex><span>    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>root@ubuntu:~# ip route list
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>root@ubuntu:~# iptables --list-rules
</span></span><span style=display:flex><span>-P INPUT ACCEPT
</span></span><span style=display:flex><span>-P FORWARD ACCEPT
</span></span><span style=display:flex><span>-P OUTPUT ACCEPT
</span></span></code></pre></div><p>This output indicates that the Bash process is operating within a fully isolated namespace (app1). There are no routing rules or custom iptables chains present, and only the loopback interface is available.</p><p>Note: <code>loopback</code> interface is a virtual network interface that allows communication between applications running on the same network namespace.</p><p><img src=network-stack.png alt=alt></p><h1 class="relative group font-normal">Network Namespace to Host connectivity<div id=network-namespace-to-host-connectivity class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#network-namespace-to-host-connectivity aria-label=Anchor>#</a></span></h1><p>Remember, network namespaces are isolated from each other and from the host. Now, let&rsquo;s establish a connection between the container&rsquo;s network namespace <code>app1</code> and the host.</p><p>To accomplish this, we&rsquo;ll use virtual Ethernet devices (veth). A veth device is a type of virtual network interface in Linux, creating a virtual network link between two network namespaces or between a network namespace and the host system.</p><p>Here&rsquo;s how it works:</p><p>A veth device is typically configured as a pair of virtual network interfaces. One end of the pair resides within the container&rsquo;s network namespace, while the other end is situated either in another network namespace or directly within the host system.</p><p>Open a new shell session to access the root network namespace:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>root@ubuntu:~# ip link add hlink1 type veth peer name clink1
</span></span></code></pre></div><p>This command creates a pair of virtual Ethernet interfaces <code>veth</code>, named <code>hlink1</code> and <code>clink1</code>, within the root network namespace. You can observe the outcome by listing the network devices using the following command.</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>root@ubuntu:~# ip link list 
</span></span><span style=display:flex><span>1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN mode DEFAULT group default qlen 1000
</span></span><span style=display:flex><span>    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
</span></span><span style=display:flex><span>2: enp0s1: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc fq_codel state UP mode DEFAULT group default qlen 1000
</span></span><span style=display:flex><span>    link/ether 06:c5:4b:b4:32:aa brd ff:ff:ff:ff:ff:ff
</span></span><span style=display:flex><span>...
</span></span><span style=display:flex><span>9: clink1@hlink1: &lt;BROADCAST,MULTICAST,M-DOWN&gt; mtu 1500 qdisc noop state DOWN mode DEFAULT group default qlen 1000
</span></span><span style=display:flex><span>    link/ether a2:08:37:6f:7a:b2 brd ff:ff:ff:ff:ff:ff
</span></span><span style=display:flex><span>10: hlink1@clink1: &lt;BROADCAST,MULTICAST,M-DOWN&gt; mtu 1500 qdisc noop state DOWN mode DEFAULT group default qlen 1000
</span></span><span style=display:flex><span>    link/ether b2:2d:19:e8:a0:28 brd ff:ff:ff:ff:ff:ff
</span></span></code></pre></div><p>The output shows that both <code>hlink1</code> and <code>clink1</code> interfaces are located within the root network namespace and the state of each one is <code>DOWN</code>.</p><p>To establish a connection between the root network namespace and the <code>app1</code> network namespace, we must retain one of the interfaces, <code>hlink1</code>, in the root namespace while relocating the other one, <code>clink1</code>, into the <code>app1</code> namespace (use the following command).</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>root@ubuntu:~# ip link set clink1 netns app1
</span></span></code></pre></div><p>Again, list the network interfaces in the root network namespace:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>root@ubuntu:~# ip link list 
</span></span><span style=display:flex><span>1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN mode DEFAULT group default qlen 1000
</span></span><span style=display:flex><span>    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
</span></span><span style=display:flex><span>2: enp0s1: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc fq_codel state UP mode DEFAULT group default qlen 1000
</span></span><span style=display:flex><span>    link/ether 06:c5:4b:b4:32:aa brd ff:ff:ff:ff:ff:ff
</span></span><span style=display:flex><span>...
</span></span><span style=display:flex><span>10: hlink1@if9: &lt;BROADCAST,MULTICAST&gt; mtu 1500 qdisc noop state DOWN mode DEFAULT group default qlen 1000
</span></span><span style=display:flex><span>    link/ether b2:2d:19:e8:a0:28 brd ff:ff:ff:ff:ff:ff link-netns app1
</span></span></code></pre></div><p>The output shows that the <code>clink1</code> interface has been removed from the network device list within the root network namespace.</p><p>Now, check the network device list in <code>app1</code> namespace.</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>root@ubuntu:~# nsenter --net=/run/netns/app1 ip link list
</span></span><span style=display:flex><span>1: lo: &lt;LOOPBACK&gt; mtu 65536 qdisc noop state DOWN mode DEFAULT group default qlen 1000
</span></span><span style=display:flex><span>    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
</span></span><span style=display:flex><span>9: clink1@if10: &lt;BROADCAST,MULTICAST&gt; mtu 1500 qdisc noop state DOWN mode DEFAULT group default qlen 1000
</span></span><span style=display:flex><span>    link/ether a2:08:37:6f:7a:b2 brd ff:ff:ff:ff:ff:ff link-netnsid 0
</span></span></code></pre></div><p>The <code>clink1</code> interface has been moved from the root network namespace to <code>app1</code>. Notice the inclusion of <code>link-netns app1</code> in the <code>hlink1</code> interface within the root network namespace&rsquo;s device list output. This indicates that the <code>hlink1</code> interface is now linked with the <code>app1</code> network namespace.</p><p>Note: keep in mind that both interfaces, <code>clink1</code> and <code>lo</code>, in <code>app1</code> network namespace are <code>DOWN</code>.</p><p>Currently, each end of the veth pair resides in its respective namespace to establish the connection between both network namespaces. However, the link cannot yet be utilized for communication between the namespaces until we assign suitable IP addresses to the different interfaces and activate them.</p><p>Let&rsquo;s assigne <code>172.16.0.11/16</code> to <code>clink1</code> within <code>app1</code> network namespace.</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>root@ubuntu:~# nsenter --net=/run/netns/app1 bash -c &#39;
</span></span><span style=display:flex><span>    ip link set clink1 up
</span></span><span style=display:flex><span>    ip addr add 172.16.0.11/16 dev clink1
</span></span><span style=display:flex><span>&#39;
</span></span></code></pre></div><p>Review the configuration of <code>clink1</code> within the <code>app1</code> network namespace to inspect the assignment of IP addresses.</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>root@ubuntu:~# nsenter --net=/run/netns/app1 ip addr show dev clink1
</span></span><span style=display:flex><span>9: clink1@if10: &lt;NO-CARRIER,BROADCAST,MULTICAST,UP&gt; mtu 1500 qdisc noqueue state LOWERLAYERDOWN group default qlen 1000
</span></span><span style=display:flex><span>    link/ether a2:08:37:6f:7a:b2 brd ff:ff:ff:ff:ff:ff link-netnsid 0
</span></span><span style=display:flex><span>    inet 172.16.0.11/16 scope global clink1
</span></span><span style=display:flex><span>       valid_lft forever preferred_lft forever
</span></span></code></pre></div><p>Additionally, we must setup the <code>loopback</code> interface within the <code>app1</code> network namespace. This ensures seamless communication among processes within the network namespace.</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>root@ubuntu:~# nsenter --net=/run/netns/app1 ip link set lo up 
</span></span></code></pre></div><p>Now, returning to the root network namespace, let&rsquo;s assign the IP address <code>172.16.0.10/16</code> to the <code>hlink1</code> interface.</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>root@ubuntu:~# ip link set hlink1 up
</span></span><span style=display:flex><span>root@ubuntu:~# ip addr add 172.16.0.10/16 dev hlink1
</span></span></code></pre></div><p>Inspect the <code>hlink1</code> configuration within the root network namespace to see the IP assignment.</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>root@ubuntu:~# ip addr show dev hlink1
</span></span><span style=display:flex><span>10: hlink1@if9: &lt;BROADCAST,MULTICAST&gt; mtu 1500 qdisc noop state DOWN group default qlen 1000
</span></span><span style=display:flex><span>    link/ether b2:2d:19:e8:a0:28 brd ff:ff:ff:ff:ff:ff link-netns app1
</span></span><span style=display:flex><span>    inet 172.16.0.10/16 scope global hlink1
</span></span><span style=display:flex><span>       valid_lft forever preferred_lft forever
</span></span></code></pre></div><p><img src=veth.png alt=alt></p><p>We&rsquo;ve successfully established the link between the <code>app1</code> network namespace and the root, as illustrated in the diagram above. Now, let&rsquo;s inspect the routing table within the <code>app1</code> and root network namespace to understand how traffic originating from <code>app1</code> namespace will be routed to reach the root.</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>root@ubuntu:~# nsenter --net=/run/netns/app1 ip route
</span></span><span style=display:flex><span>172.16.0.0/16 dev clink1 proto kernel scope link src 172.16.0.11
</span></span></code></pre></div><p>The output shows that traffic distinated for <code>172.16.0.0/16</code> will be routed through the <code>clink1</code> interface. Given that <code>clink1</code> is one end of the <code>veth</code> pair, it implies that any traffic traversing this interface will also be observable on the other end of the link <code>hlink1</code> within the root namespace.</p><p>Then the routing table of the root network namespace.</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>root@ubuntu:~# ip route
</span></span><span style=display:flex><span>default via 192.168.64.1 dev enp0s1 proto dhcp src 192.168.64.3 metric 100 
</span></span><span style=display:flex><span>172.16.0.0/16 dev hlink1 proto kernel scope link src 172.16.0.10 
</span></span><span style=display:flex><span>192.168.64.0/24 dev enp0s1 proto kernel scope link src 192.168.64.3 metric 100 
</span></span><span style=display:flex><span>192.168.64.1 dev enp0s1 proto dhcp scope link src 192.168.64.3 metric 100 
</span></span></code></pre></div><p>The route <code>172.16.0.0/16 dev hlink1 proto kernel scope link src 172.16.0.10</code> indicates that traffic destined for <code>172.16.0.0/16</code> will be routed through the <code>hlink1</code> interface. Since <code>hlink1</code> is one end of the <code>veth</code> pair, it also means that any traffic passing through this interface will also be visible on the other end of the link, <code>clink1</code>, within the <code>app1</code> network namespace.</p><p>Let&rsquo;s start our first connectivity test by pinging <code>hlink1</code> from the <code>app1</code> network namespace.</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>root@ubuntu:~# nsenter --net=/run/netns/app1 ping 172.16.0.10
</span></span><span style=display:flex><span>PING 172.16.0.10 (172.16.0.10) 56(84) bytes of data.
</span></span><span style=display:flex><span>64 bytes from 172.16.0.10: icmp_seq=1 ttl=64 time=0.224 ms
</span></span><span style=display:flex><span>64 bytes from 172.16.0.10: icmp_seq=2 ttl=64 time=0.045 ms
</span></span></code></pre></div><p>And now, <code>clink1</code> from the root network namespace.</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>root@ubuntu:~# ping 172.16.0.11
</span></span><span style=display:flex><span>PING 172.16.0.11 (172.16.0.11) 56(84) bytes of data.
</span></span><span style=display:flex><span>64 bytes from 172.16.0.11: icmp_seq=1 ttl=64 time=0.047 ms
</span></span><span style=display:flex><span>64 bytes from 172.16.0.11: icmp_seq=2 ttl=64 time=0.060 ms
</span></span></code></pre></div><p>The connectivity test has been successful between root network namespace and <code>app1</code>.</p><h1 class="relative group font-normal">Network Namespace to Network Namespace connectivity<div id=network-namespace-to-network-namespace-connectivity class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#network-namespace-to-network-namespace-connectivity aria-label=Anchor>#</a></span></h1><p>In this section, we&rsquo;ll demonstrate that relying only on veth pairs isn&rsquo;t enough to interconnect two or more containers. This leads to conflicts in the Layer 3 (L3) routing table caused by introducing separate rules for different network namespaces in root namespace routing table. Let&rsquo;s create a second network namespace <code>app2</code> and configure the veth pair as in the <code>app1</code>:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>ip netns add app2
</span></span><span style=display:flex><span>ip link add hlink2 type veth peer name clink2
</span></span><span style=display:flex><span>ip link set hlink2 up
</span></span><span style=display:flex><span>ip addr add 172.16.0.20/16 dev hlink2
</span></span><span style=display:flex><span>ip link set clink2 netns app2
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>nsenter --net=/run/netns/app2 bash -c &#39;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    ip link set lo up
</span></span><span style=display:flex><span>    ip link set clink2 up
</span></span><span style=display:flex><span>    ip addr add 172.16.0.21/16 dev clink2
</span></span><span style=display:flex><span>    exit
</span></span><span style=display:flex><span>    &#39;
</span></span></code></pre></div><p>Now, check the routing table of the root network namespace:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>root@ubuntu:~# ip route
</span></span><span style=display:flex><span>...
</span></span><span style=display:flex><span>172.16.0.0/16 dev hlink1 proto kernel scope link src 172.16.0.10 # app1
</span></span><span style=display:flex><span>172.16.0.0/16 dev hlink2 proto kernel scope link src 172.16.0.20 # app2
</span></span><span style=display:flex><span>...
</span></span></code></pre></div><p>As you can see, the root network namespace&rsquo;s routing table encountered a conflict. After adding the second veth pair, a new route was added: <code>172.16.0.0/16 dev hlink2 proto kernel scope link src 172.16.0.20</code>. However, there was already an existing route for the <code>172.16.0.0/16</code> network. Consequently, when <code>app2</code> tries to ping the <code>hlink2</code> device, the first route is chosen, leading to connectivity issues.</p><p><img src=multi-ns.png alt=alt></p><p>Connectivity test again.</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>root@ubuntu:~# nsenter --net=/run/netns/app2 ping 172.16.0.20 # ping root&#39;s interface hlink2
</span></span><span style=display:flex><span>PING 172.16.0.20 (172.16.0.20) 56(84) bytes of data.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>--- 172.16.0.20 ping statistics ---
</span></span><span style=display:flex><span>2 packets transmitted, 0 received, 100% packet loss, time 1023ms
</span></span></code></pre></div><p>As expected, the connectivity test confirmes that accessing <code>hlink2</code> from <code>app2</code> is not feasible, even with the routes present in routing tables.</p><p>Alternatively, to confirm this, we can use tcpdump on the <code>hlink2</code> interface within the root network namespace. By running the command <code>tcpdump -i hlink2 icmp</code>, all ICMP packets passing through the <code>hlink2</code> interface are captured. However, in this scenario, no traffic will be captured.</p><h2 class="relative group font-normal">Linux Bridge<div id=linux-bridge class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#linux-bridge aria-label=Anchor>#</a></span></h2><p>The previous issue pushed us to explore alternatives for interconnecting containers, leading us to the Linux feature known as Linux Bridge. Operating similarly to a network switch, a Linux bridge facilitates packet forwarding between connected interfaces at the L2 level. (Please check <a href=https://fence-io.github.io/website/articles/networking/load-balancer-cilium-kind>Setting up Load Balancer Service with Cilium in KinD Cluster</a> for more details on l2 connectivity)</p><p>In the container ecosystem, the bridge acts as a virtual networking interface, linking container&rsquo;s network namespace through virtual Ethernet pairs. Each network namespace is equipped with its own veth pair, with one end attached to the bridge network. This setup facilitates internal communication between containers and with the host system.</p><p><img src=bridge-network.png alt=alt></p><p>In this section, we will connect two new network namespaces to each other using a bridge. To begin, create two new network namespaces named <code>app3</code> and <code>app4</code>.</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>ip netns add app3
</span></span><span style=display:flex><span>ip link add hlink3 type veth peer name clink3
</span></span><span style=display:flex><span>ip link set hlink3 up
</span></span><span style=display:flex><span>ip link set clink3 netns app3
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>nsenter --net=/run/netns/app3 bash -c &#39;
</span></span><span style=display:flex><span>    ip link set lo up
</span></span><span style=display:flex><span>    ip link set clink3 up
</span></span><span style=display:flex><span>    ip addr add 172.16.0.30/16 dev clink3
</span></span><span style=display:flex><span>    ip link
</span></span><span style=display:flex><span>&#39;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>ip netns add app4
</span></span><span style=display:flex><span>ip link add hlink4 type veth peer name clink4
</span></span><span style=display:flex><span>ip link set hlink4 up
</span></span><span style=display:flex><span>ip link set clink4 netns app4
</span></span><span style=display:flex><span>ip link
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>nsenter --net=/run/netns/app4 bash -c &#39;
</span></span><span style=display:flex><span>    ip link set lo up
</span></span><span style=display:flex><span>    ip link set clink4 up
</span></span><span style=display:flex><span>    ip addr add 172.16.0.40/16 dev clink4
</span></span><span style=display:flex><span>    ip link
</span></span><span style=display:flex><span>&#39;
</span></span></code></pre></div><p>Make sure that there is no new routes added to the routing table of the root namespace:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>root@ubuntu:~# ip route 
</span></span><span style=display:flex><span>default via 192.168.64.1 dev enp0s1 proto dhcp src 192.168.64.3 metric 100 
</span></span><span style=display:flex><span>192.168.64.0/24 dev enp0s1 proto kernel scope link src 192.168.64.3 metric 100 
</span></span><span style=display:flex><span>192.168.64.1 dev enp0s1 proto dhcp scope link src 192.168.64.3 metric 100 
</span></span></code></pre></div><p>Now, let&rsquo;s create the bridge device and connect <code>hlink3</code> and <code>hlink4</code> to it to ensure connectivity between the containers.</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>ip link add br0 type bridge 
</span></span><span style=display:flex><span>ip link set br0 up
</span></span><span style=display:flex><span>ip link set hlink3 master br0
</span></span><span style=display:flex><span>ip link set hlink4 master br0
</span></span><span style=display:flex><span>ip link
</span></span></code></pre></div><p><img src=ns-via-bridge.png alt=alt></p><h2 class="relative group font-normal">Connectivity Test<div id=connectivity-test class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#connectivity-test aria-label=Anchor>#</a></span></h2><p>Note: If you are running docker in your host, make sure to remove <code>br_netfilter</code> kernel module <code>rmmod br_netfilter</code> (for more details <a href=https://unix.stackexchange.com/questions/671644/cant-establish-communication-between-two-network-namespaces-using-bridge-networ>https://unix.stackexchange.com/questions/671644/cant-establish-communication-between-two-network-namespaces-using-bridge-networ</a>)</p><p>Before conducting the ping test, make sure to run tcpdump on the bridge interface to capture the <code>ICMP</code> traffic passing through the bridge while both containers, <code>app3</code> and <code>app4</code> communicate.</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>tcpdump -i br0 icmp
</span></span></code></pre></div><p>Now, switch to another shell session and run the following connectivity tests:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>root@ubuntu:~# nsenter --net=/run/netns/app3 ping -c 2 172.16.0.40 # ping app4
</span></span><span style=display:flex><span>PING 172.16.0.40 (172.16.0.40) 56(84) bytes of data.
</span></span><span style=display:flex><span>64 bytes from 172.16.0.40: icmp_seq=1 ttl=64 time=0.142 ms
</span></span><span style=display:flex><span>64 bytes from 172.16.0.40: icmp_seq=2 ttl=64 time=0.071 ms
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>--- 172.16.0.40 ping statistics ---
</span></span><span style=display:flex><span>2 packets transmitted, 2 received, 0% packet loss, time 1025ms
</span></span><span style=display:flex><span>rtt min/avg/max/mdev = 0.071/0.106/0.142/0.035 ms
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>root@ubuntu:~# nsenter --net=/run/netns/app4 ping -c 2 172.16.0.30 # ping app3
</span></span><span style=display:flex><span>PING 172.16.0.30 (172.16.0.30) 56(84) bytes of data.
</span></span><span style=display:flex><span>64 bytes from 172.16.0.30: icmp_seq=1 ttl=64 time=0.053 ms
</span></span><span style=display:flex><span>64 bytes from 172.16.0.30: icmp_seq=2 ttl=64 time=0.057 ms
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>--- 172.16.0.30 ping statistics ---
</span></span><span style=display:flex><span>2 packets transmitted, 2 received, 0% packet loss, time 1028ms
</span></span><span style=display:flex><span>rtt min/avg/max/mdev = 0.053/0.055/0.057/0.002 ms
</span></span></code></pre></div><p>We can see from the <code>tcpdump</code> output bellow, that the <code>ICMP</code> traffic if going through brigde interface to reach each destination network namespace.</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>root@ubuntu:~# tcpdump -i br0 icmp
</span></span><span style=display:flex><span>tcpdump: verbose output suppressed, use -v[v]... for full protocol decode
</span></span><span style=display:flex><span>listening on br0, link-type EN10MB (Ethernet), snapshot length 262144 bytes
</span></span><span style=display:flex><span>16:19:13.037613 IP 172.16.0.30 &gt; 172.16.0.40: ICMP echo request, id 44793, seq 1, length 64
</span></span><span style=display:flex><span>16:19:13.037626 IP 172.16.0.40 &gt; 172.16.0.30: ICMP echo reply, id 44793, seq 1, length 64
</span></span><span style=display:flex><span>16:19:14.062746 IP 172.16.0.30 &gt; 172.16.0.40: ICMP echo request, id 44793, seq 2, length 64
</span></span><span style=display:flex><span>16:19:14.062781 IP 172.16.0.40 &gt; 172.16.0.30: ICMP echo reply, id 44793, seq 2, length 64
</span></span><span style=display:flex><span>16:19:42.217807 IP 172.16.0.40 &gt; 172.16.0.30: ICMP echo request, id 13480, seq 1, length 64
</span></span><span style=display:flex><span>16:19:42.217839 IP 172.16.0.30 &gt; 172.16.0.40: ICMP echo reply, id 13480, seq 1, length 64
</span></span><span style=display:flex><span>16:19:43.245866 IP 172.16.0.40 &gt; 172.16.0.30: ICMP echo request, id 13480, seq 2, length 64
</span></span><span style=display:flex><span>16:19:43.245894 IP 172.16.0.30 &gt; 172.16.0.40: ICMP echo reply, id 13480, seq 2, length 64
</span></span></code></pre></div><p>The test is a success!</p><p>Remember, we did not assigne any IP addresses for <code>hlink3</code> and <code>hlink4</code>; instead, we assigned IPs only to <code>clink3</code> and <code>clink4</code>. As <code>hlink3</code> and <code>hlink4</code> belong to the same Ethernet segment (connected to the <code>bridge</code>), L2 connectivity is established based on MAC addresses. This is further confirmed by inspecting the ARP table in both namespaces.</p><p>ARP (Address Resolution Protocol) table in Linux offers a mapping between IP addresses and MAC addresses of devices on the local network segment (L2 segment).</p><p>When two devices within the same L2 segment, such as <code>app3</code> and <code>app4</code> connected via the bridge, need to communicate, they rely on MAC addresses. The <code>ARP table</code> entries play a crucial role in this process by actively providing the necessary MAC destination address for constructing the L2 frame.</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>root@ubuntu:~# nsenter --net=/run/netns/app3 arp -n
</span></span><span style=display:flex><span>Address                  HWtype  HWaddress           Flags Mask            Iface
</span></span><span style=display:flex><span>172.16.0.40              ether   52:45:d1:3a:b3:32   C                     clink3
</span></span></code></pre></div><p>In the <code>ARP</code> table of <code>app3</code>, we observe that the destination MAC address for <code>app4</code> is <code>52:45:d1:3a:b3:32</code>, corresponding to the destination IP address of <code>172.16.0.40</code>.</p><p>Same in <code>app4</code>.</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>root@ubuntu:~# nsenter --net=/run/netns/app4 arp -n
</span></span><span style=display:flex><span>Address                  HWtype  HWaddress           Flags Mask            Iface
</span></span><span style=display:flex><span>172.16.0.30              ether   82:6e:c9:b4:c0:79   C                     clink4
</span></span></code></pre></div><p>Note: To get the MAC address of each network interface, execute <code>ip addr show INTF_NAME</code>.</p><p>Alternatively, the <code>ip neigh</code> command offers information about the neighbor cache.</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>root@ubuntu:~# nsenter --net=/run/netns/app3 ip neigh
</span></span><span style=display:flex><span>172.16.0.40 dev clink3 lladdr 52:45:d1:3a:b3:32 REACHABLE
</span></span></code></pre></div><p>In this specific output, we see that <code>app3</code> has a neighbor device with the IP address <code>172.16.0.40</code> (app4), accessible through the <code>clink3</code> interface. The MAC address (L2 address) of this neighbor device is identified as <code>52:45:d1:3a:b3:32</code>. Furthermore, the state of this entry in the neighbor cache is marked as <code>REACHABLE</code>, indicating that the MAC address is presently known and accessible.</p><p>After establishing the connection between <code>app3</code> and <code>app4</code>, it&rsquo;s now time to enssure the connectivity between the host (root network namespace) and both <code>app3</code> and <code>app4</code>. First, let&rsquo;s attempt to ping <code>app3</code> from the root network namespace.</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>root@ubuntu:~# ping -c 2 172.16.0.30
</span></span><span style=display:flex><span>PING 172.16.0.30 (172.16.0.30) 56(84) bytes of data.
</span></span><span style=display:flex><span>From 172.16.0.10 icmp_seq=1 Destination Host Unreachable
</span></span><span style=display:flex><span>From 172.16.0.10 icmp_seq=2 Destination Host Unreachable
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>--- 172.16.0.30 ping statistics ---
</span></span><span style=display:flex><span>2 packets transmitted, 0 received, +2 errors, 100% packet loss, time 1017ms
</span></span></code></pre></div><p>The root namespace is currently unable to communicate with the <code>app3</code> network namespace because there&rsquo;s no route in root&rsquo;s routing table allowing to reach <code>app3</code>. To fix this, we first need to assign an IP address to the bridge network interface itself.</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>ip addr add 172.16.0.1/16 dev br0
</span></span></code></pre></div><p>Assigning an IP address to <code>br0</code> updates the root namespace routing table with the route: <code>172.16.0.0/16 dev br0 proto kernel scope link src 172.16.0.1</code> (you can see it by running <code>ip route</code> in root network namespace). This indicates that traffic destined for the <code>172.16.0.0/16</code> subnet can be routed via the <code>br0</code> interface. Given that <code>hlink1</code> and <code>hlink2</code> are also connected to the bridge, this implies that traffic will be appropriately directed to the target namespaces.</p><p>Remember, the bridge operates at the data link layer (L2), so once traffic is routed to the bridge interface, an <code>ARP</code> request is broadcasted to all devices connected to the bridge, requesting the destination MAC address. The device that possesses the MAC address will respond, and the Ethernet frame will be filled with the destination MAC address before being sent to its destination within this L2 segment.</p><p>After this configuration, we should be able to ping <code>app3</code> and <code>app4</code> from the root network namespace.</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>root@ubuntu:~# ping -c 2 172.16.0.30
</span></span><span style=display:flex><span>PING 172.16.0.30 (172.16.0.30) 56(84) bytes of data.
</span></span><span style=display:flex><span>64 bytes from 172.16.0.30: icmp_seq=1 ttl=64 time=0.085 ms
</span></span><span style=display:flex><span>64 bytes from 172.16.0.30: icmp_seq=2 ttl=64 time=0.069 ms
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>--- 172.16.0.30 ping statistics ---
</span></span><span style=display:flex><span>2 packets transmitted, 2 received, 0% packet loss, time 1016ms
</span></span><span style=display:flex><span>rtt min/avg/max/mdev = 0.069/0.077/0.085/0.008 ms
</span></span></code></pre></div><p>Aditionnaly, we also need to add a default route to <code>app3</code> and <code>app4</code>. This means that when a destination IP address of a packet does not match any specific routes in the routing table, it will go througt the default route, the bridge interface in this case.</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>root@ubuntu:~# nsenter --net=/run/netns/app3 ip route add default via 172.16.0.1
</span></span><span style=display:flex><span>root@ubuntu:~# nsenter --net=/run/netns/app4 ip route add default via 172.16.0.1
</span></span></code></pre></div><p>Now, <code>app3</code> and <code>app4</code> can reach any subnet within the host. Try to ping <code>eth0</code> for example.</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>root@ubuntu:~# nsenter --net=/run/netns/app3  ping -c 2 192.168.64.3
</span></span><span style=display:flex><span>PING 192.168.64.3 (192.168.64.3) 56(84) bytes of data.
</span></span><span style=display:flex><span>64 bytes from 192.168.64.3: icmp_seq=1 ttl=64 time=0.184 ms
</span></span><span style=display:flex><span>64 bytes from 192.168.64.3: icmp_seq=2 ttl=64 time=0.066 ms
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>--- 192.168.64.3 ping statistics ---
</span></span><span style=display:flex><span>2 packets transmitted, 2 received, 0% packet loss, time 1019ms
</span></span><span style=display:flex><span>rtt min/avg/max/mdev = 0.066/0.125/0.184/0.059 ms
</span></span></code></pre></div><p>Great! We are able to go from the containers to the host and back.</p><h1 class="relative group font-normal">Internet Connectivity<div id=internet-connectivity class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#internet-connectivity aria-label=Anchor>#</a></span></h1><p>The standard method for connecting a network namespace to the internet involves Network Address Translation (NAT). NAT is a networking technique that modifies the source or destination IP addresses of packets as they travel through a router. It allows multiple devices within a local network to share a single public IP address when accessing online resources.</p><p>To achieve this, we must first enable packet forwarding, which is typically disabled by default in Linux. Enabling it, usually from the root namespace, transforms the host machine into a router, with the bridge interface acting as the default gateway for the containers.</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>echo 1 &gt; /proc/sys/net/ipv4/ip_forward
</span></span></code></pre></div><p>Packets originating from the network namespace will have their source IP addresses replaced with the host&rsquo;s external interface address. Additionally, the host will track all existing mappings and restore the IP addresses before forwarding packets back to the containers. The following command will enable this.</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>iptables -t nat -A POSTROUTING -s 172.16.0.0/16 ! -o br0 -j MASQUERADE
</span></span></code></pre></div><p>This iptables rule performs NAT for outgoing packets from the 172.16.0.0/16 subnet, excluding those destined for the &ldquo;br0&rdquo; interface. It dynamically translates the source IP addresses of these packets to the IP address of the host&rsquo;s external interface, allowing internal IPs to appear as originating from the host&rsquo;s public IP address.</p><p><img src=nat.png alt=alt></p><h1 class="relative group font-normal">Docker Networks<div id=docker-networks class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#docker-networks aria-label=Anchor>#</a></span></h1><p>In the context of Docker, a Linux bridge is a common networking solution used to connect containers. Docker creates a bridge network by default for each Docker daemon (docker0).</p><p>Each container is attached to this bridge network, which allows them to communicate with each other. Docker creates virtual Ethernet pairs to connect containers to the bridge network. Each container gets its own network namespace, ensuring network isolation.</p><p>Docker has also other network types:</p><p><a href=https://docs.docker.com/network/drivers/host/>Host network</a>: Docker also offers the option to use the host&rsquo;s networking namespace instead of creating a separate network namespace for each container. In this mode, containers share the network namespace with the host, bypassing network isolation but potentially offering better performance.</p><p><a href=https://docs.docker.com/network/drivers/none/>None</a>: In this mode, Docker completely isolates the network namespace from the host. It configures only the loopback interface within the network namespace, ensuring that the container operates in a fully isolated networking environment.</p><p><a href=https://docs.docker.com/network/drivers/overlay/>Overlay Networks</a>: Docker supports overlay networks, which enable communication between containers running on different hosts. Overlay networks use VXLAN encapsulation (wait for our next article for more details on this topic) to extend layer 2 networking across hosts.</p><p>Custom Networks: Docker allows users to create custom networks with specific configurations. These custom networks provide additional flexibility and control over container networking.</p><h1 class="relative group font-normal">Conclusion<div id=conclusion class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#conclusion aria-label=Anchor>#</a></span></h1><p>Understanding Linux networking features is fundamental to many containerization technologies. This foundational knowledge serves as a basis for comprehending higher-level networking concepts used in Kubernetes. In our upcoming article, we&rsquo;ll explore how Container Runtime Interface (CRI) and Container Network Interface (CNI) leverage these features within the Kubernetes ecosystem.</p><p>You&rsquo;ll discover a script containing all the commands demonstrated in this article <a href=https://github.com/fence-io/playground/tree/main/networking/linux-network-namespace>here</a>. Also, consider using codespaces to run the lab.</p><div class="flex flex-row flex-wrap justify-center pt-4 text-xl"><a target=_blank class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https://fence-io.github.io/website/articles/networking/diving-deep-into-container-networking/&amp;title=Diving%20deep%20into%20Container%20Networking%20%28An%20Exploration%20of%20Linux%20Network%20Namespace%29" title="Share on LinkedIn" aria-label="Share on LinkedIn"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentcolor" d="M416 32H31.9C14.3 32 0 46.5.0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6.0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3.0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2.0 38.5 17.3 38.5 38.5.0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6.0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2.0 79.7 44.3 79.7 101.9V416z"/></svg>
</span></a><a target=_blank class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://twitter.com/intent/tweet/?url=https://fence-io.github.io/website/articles/networking/diving-deep-into-container-networking/&amp;text=Diving%20deep%20into%20Container%20Networking%20%28An%20Exploration%20of%20Linux%20Network%20Namespace%29" title="Tweet on Twitter" aria-label="Tweet on Twitter"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8L200.7 275.5 26.8 48H172.4L272.9 180.9 389.2 48zM364.4 421.8h39.1L151.1 88h-42L364.4 421.8z"/></svg>
</span></a><a target=_blank class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://reddit.com/submit/?url=https://fence-io.github.io/website/articles/networking/diving-deep-into-container-networking/&amp;resubmit=true&amp;title=Diving%20deep%20into%20Container%20Networking%20%28An%20Exploration%20of%20Linux%20Network%20Namespace%29" title="Submit to Reddit" aria-label="Submit to Reddit"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M201.5 305.5c-13.8.0-24.9-11.1-24.9-24.6.0-13.8 11.1-24.9 24.9-24.9 13.6.0 24.6 11.1 24.6 24.9.0 13.6-11.1 24.6-24.6 24.6zM504 256c0 137-111 248-248 248S8 393 8 256 119 8 256 8s248 111 248 248zm-132.3-41.2c-9.4.0-17.7 3.9-23.8 10-22.4-15.5-52.6-25.5-86.1-26.6l17.4-78.3 55.4 12.5c0 13.6 11.1 24.6 24.6 24.6 13.8.0 24.9-11.3 24.9-24.9s-11.1-24.9-24.9-24.9c-9.7.0-18 5.8-22.1 13.8l-61.2-13.6c-3-.8-6.1 1.4-6.9 4.4l-19.1 86.4c-33.2 1.4-63.1 11.3-85.5 26.8-6.1-6.4-14.7-10.2-24.1-10.2-34.9.0-46.3 46.9-14.4 62.8-1.1 5-1.7 10.2-1.7 15.5.0 52.6 59.2 95.2 132 95.2 73.1.0 132.3-42.6 132.3-95.2.0-5.3-.6-10.8-1.9-15.8 31.3-16 19.8-62.5-14.9-62.5zM302.8 331c-18.2 18.2-76.1 17.9-93.6.0-2.2-2.2-6.1-2.2-8.3.0-2.5 2.5-2.5 6.4.0 8.6 22.8 22.8 87.3 22.8 110.2.0 2.5-2.2 2.5-6.1.0-8.6-2.2-2.2-6.1-2.2-8.3.0zm7.7-75c-13.6.0-24.6 11.1-24.6 24.9.0 13.6 11.1 24.6 24.6 24.6 13.8.0 24.9-11.1 24.9-24.6.0-13.8-11-24.9-24.9-24.9z"/></svg>
</span></a><a target=_blank class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://api.whatsapp.com/send?text=https://fence-io.github.io/website/articles/networking/diving-deep-into-container-networking/&amp;resubmit=true&amp;title=Diving%20deep%20into%20Container%20Networking%20%28An%20Exploration%20of%20Linux%20Network%20Namespace%29" title aria-label><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentcolor" d="M380.9 97.1C339 55.1 283.2 32 223.9 32c-122.4.0-222 99.6-222 222 0 39.1 10.2 77.3 29.6 111L0 480l117.7-30.9c32.4 17.7 68.9 27 106.1 27h.1c122.3.0 224.1-99.6 224.1-222 0-59.3-25.2-115-67.1-157zm-157 341.6c-33.2.0-65.7-8.9-94-25.7l-6.7-4-69.8 18.3L72 359.2l-4.4-7c-18.5-29.4-28.2-63.3-28.2-98.2.0-101.7 82.8-184.5 184.6-184.5 49.3.0 95.6 19.2 130.4 54.1 34.8 34.9 56.2 81.2 56.1 130.5.0 101.8-84.9 184.6-186.6 184.6zm101.2-138.2c-5.5-2.8-32.8-16.2-37.9-18-5.1-1.9-8.8-2.8-12.5 2.8s-14.3 18-17.6 21.8c-3.2 3.7-6.5 4.2-12 1.4-32.6-16.3-54-29.1-75.5-66-5.7-9.8 5.7-9.1 16.3-30.3 1.8-3.7.9-6.9-.5-9.7-1.4-2.8-12.5-30.1-17.1-41.2-4.5-10.8-9.1-9.3-12.5-9.5-3.2-.2-6.9-.2-10.6-.2s-9.7 1.4-14.8 6.9c-5.1 5.6-19.4 19-19.4 46.3.0 27.3 19.9 53.7 22.6 57.4 2.8 3.7 39.1 59.7 94.8 83.8 35.2 15.2 49 16.5 66.6 13.9 10.7-1.6 32.8-13.4 37.4-26.4 4.6-13 4.6-24.1 3.2-26.4-1.3-2.5-5-3.9-10.5-6.6z"/></svg>
</span></a><a target=_blank class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://t.me/share/url?url=https://fence-io.github.io/website/articles/networking/diving-deep-into-container-networking/&amp;resubmit=true&amp;title=Diving%20deep%20into%20Container%20Networking%20%28An%20Exploration%20of%20Linux%20Network%20Namespace%29" title aria-label><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentcolor" d="M248 8C111.033 8 0 119.033.0 256S111.033 504 248 504 496 392.967 496 256 384.967 8 248 8zM362.952 176.66c-3.732 39.215-19.881 134.378-28.1 178.3-3.476 18.584-10.322 24.816-16.948 25.425-14.4 1.326-25.338-9.517-39.287-18.661-21.827-14.308-34.158-23.215-55.346-37.177-24.485-16.135-8.612-25 5.342-39.5 3.652-3.793 67.107-61.51 68.335-66.746.153-.655.3-3.1-1.154-4.384s-3.59-.849-5.135-.5q-3.283.746-104.608 69.142-14.845 10.194-26.894 9.934c-8.855-.191-25.888-5.006-38.551-9.123-15.531-5.048-27.875-7.717-26.8-16.291q.84-6.7 18.45-13.7 108.446-47.248 144.628-62.3c68.872-28.647 83.183-33.623 92.511-33.789 2.052-.034 6.639.474 9.61 2.885a10.452 10.452.0 013.53 6.716A43.765 43.765.0 01362.952 176.66z"/></svg>
</span></a><a target=_blank class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://pinterest.com/pin/create/bookmarklet/?url=https://fence-io.github.io/website/articles/networking/diving-deep-into-container-networking/&amp;description=Diving%20deep%20into%20Container%20Networking%20%28An%20Exploration%20of%20Linux%20Network%20Namespace%29" title="Pin on Pinterest" aria-label="Pin on Pinterest"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentcolor" d="M496 256c0 137-111 248-248 248-25.6.0-50.2-3.9-73.4-11.1 10.1-16.5 25.2-43.5 30.8-65 3-11.6 15.4-59 15.4-59 8.1 15.4 31.7 28.5 56.8 28.5 74.8.0 128.7-68.8 128.7-154.3.0-81.9-66.9-143.2-152.9-143.2-107 0-163.9 71.8-163.9 150.1.0 36.4 19.4 81.7 50.3 96.1 4.7 2.2 7.2 1.2 8.3-3.3.8-3.4 5-20.3 6.9-28.1.6-2.5.3-4.7-1.7-7.1-10.1-12.5-18.3-35.3-18.3-56.6.0-54.7 41.4-107.6 112-107.6 60.9.0 103.6 41.5 103.6 100.9.0 67.1-33.9 113.6-78 113.6-24.3.0-42.6-20.1-36.7-44.8 7-29.5 20.5-61.3 20.5-82.6.0-19-10.2-34.9-31.4-34.9-24.9.0-44.9 25.7-44.9 60.2.0 22 7.4 36.8 7.4 36.8s-24.5 103.8-29 123.2c-5 21.4-3 51.6-.9 71.2C65.4 450.9.0 361.1.0 256 0 119 111 8 248 8s248 111 248 248z"/></svg>
</span></a><a target=_blank class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://www.facebook.com/sharer/sharer.php?u=https://fence-io.github.io/website/articles/networking/diving-deep-into-container-networking/&amp;quote=Diving%20deep%20into%20Container%20Networking%20%28An%20Exploration%20of%20Linux%20Network%20Namespace%29" title="Share on Facebook" aria-label="Share on Facebook"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M504 256C504 119 393 8 256 8S8 119 8 256c0 123.78 90.69 226.38 209.25 245V327.69h-63V256h63v-54.64c0-62.15 37-96.48 93.67-96.48 27.14.0 55.52 4.84 55.52 4.84v61h-31.28c-30.8.0-40.41 19.12-40.41 38.73V256h68.78l-11 71.69h-57.78V501C413.31 482.38 504 379.78 504 256z"/></svg>
</span></a><a target=_blank class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="mailto:?body=https://fence-io.github.io/website/articles/networking/diving-deep-into-container-networking/&amp;subject=Diving%20deep%20into%20Container%20Networking%20%28An%20Exploration%20of%20Linux%20Network%20Namespace%29" title="Send via email" aria-label="Send via email"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M207.8 20.73c-93.45 18.32-168.7 93.66-187 187.1-27.64 140.9 68.65 266.2 199.1 285.1 19.01 2.888 36.17-12.26 36.17-31.49l1e-4-.6631c0-15.74-11.44-28.88-26.84-31.24-84.35-12.98-149.2-86.13-149.2-174.2.0-102.9 88.61-185.5 193.4-175.4 91.54 8.869 158.6 91.25 158.6 183.2v16.16c0 22.09-17.94 40.05-40 40.05s-40.01-17.96-40.01-40.05v-120.1c0-8.847-7.161-16.02-16.01-16.02l-31.98.0036c-7.299.0-13.2 4.992-15.12 11.68-24.85-12.15-54.24-16.38-86.06-5.106-38.75 13.73-68.12 48.91-73.72 89.64-9.483 69.01 43.81 128 110.9 128 26.44.0 50.43-9.544 69.59-24.88 24 31.3 65.23 48.69 109.4 37.49C465.2 369.3 496 324.1 495.1 277.2V256.3c0-149.2-133.9-265.632-287.3-235.57zM239.1 304.3c-26.47.0-48-21.56-48-48.05s21.53-48.05 48-48.05 48 21.56 48 48.05-20.6 48.05-48 48.05z"/></svg></span></a></div></div><div class="hidden md:block mx-8"><div class="flex flex-col sticky top-[8.4rem]"><div class="toc print:hidden"><details open class="toc-right mt-0 overflow-hidden"><summary class="block py-1 text-lg font-semibold cursor-pointer text-neutral-100">Table of Contents</summary><div class="py-1 border-dotted border-l pl-5 border-neutral-600"><nav id=TableOfContents><ul><li><a href=#introduction>Introduction</a></li><li><a href=#requirements>Requirements</a></li><li><a href=#dive-into-the-foundations-of-container-networking>Dive Into The Foundations of Container Networking</a><ul><li><a href=#what-constitutes-a-networking-stack>What constitutes a Networking Stack?</a></li><li><a href=#inspect-the-network-environment>Inspect the Network Environment</a></li></ul></li><li><a href=#create-a-network-namespace>Create A Network Namespace</a></li><li><a href=#network-namespace-to-host-connectivity>Network Namespace to Host connectivity</a></li><li><a href=#network-namespace-to-network-namespace-connectivity>Network Namespace to Network Namespace connectivity</a><ul><li><a href=#linux-bridge>Linux Bridge</a></li><li><a href=#connectivity-test>Connectivity Test</a></li></ul></li><li><a href=#internet-connectivity>Internet Connectivity</a></li><li><a href=#docker-networks>Docker Networks</a></li><li><a href=#conclusion>Conclusion</a></li></ul></nav></div></details><script>(function(){var t,e=$("#TableOfContents");if(console.log(e),e.length>0){t=$(window);function n(){var n,i=t.scrollTop(),o=$(".anchor"),s="";if(console.log(o),o.each(function(e,t){t=$(t),t.offset().top-$(window).height()/3<=i&&(s=t.attr("id"))}),n=e.find("a.active"),n.length==1&&n.eq(0).attr("href")=="#"+s)return!0;n.each(function(e,t){$(t).removeClass("active")}),e.find('a[href="#'+s+'"]').addClass("active")}t.on("scroll",n)}})()</script></div><a href=https://codespaces.new/fence-io/playground target=_blank class=mt-5><img src=https://github.com/codespaces/badge.svg alt='Open in GitHub Codespaces' style=max-width:100%></a></div><div class="absolute top-[110vh] bottom-[4rem] w-12 mx-auto overflow-y-clip"><div class="sticky top-[calc(100vh-5rem)] pb-1 flex items-center justify-center space-x-7"><a href=#top class="p-2 w-12 h-12 ring-1 ring-slate-900/5 dark:ring-slate-200/20 shadow-lg rounded-full text-base hover:text-primary-600 dark:hover:text-primary-400"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentcolor"><path stroke-linecap="round" stroke-linejoin="round" d="M4.5 10.5 12 3m0 0 7.5 7.5M12 3v18"/></svg></a></div></div></div></div></div></main><div class="bg-neutral/70 text-neutral-900 dark:bg-neutral-900/70 dark:text-neutral"><div class="mx-6 my-2"><nav class="flex md:hidden items-center justify-between space-x-2 mb-2"><a href=https://github.com/fence-io/website class="flex items-center" target=_blank><span><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentcolor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6.0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6.0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3.0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1.0-6.2-.3-40.4-.3-61.4.0.0-70 15-84.7-29.8.0.0-11.4-29.1-27.8-36.6.0.0-22.9-15.7 1.6-15.4.0.0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5.0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9.0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4.0 33.7-.3 75.4-.3 83.6.0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6.0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9.0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg></span></span><p class="text-base font-medium" title></p></a><a href=https://twitter.com/FenceCommunity class="flex items-center" target=_blank><span><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8L200.7 275.5 26.8 48H172.4L272.9 180.9 389.2 48zM364.4 421.8h39.1L151.1 88h-42L364.4 421.8z"/></svg></span></span><p class="text-base font-medium" title></p></a><a href=https://fence-io.slack.com class="flex items-center" target=_blank><span><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentcolor" d="M94.12 315.1c0 25.9-21.16 47.06-47.06 47.06S0 341 0 315.1s21.16-47.06 47.06-47.06h47.06v47.06zm23.72.0c0-25.9 21.16-47.06 47.06-47.06s47.06 21.16 47.06 47.06v117.84c0 25.9-21.16 47.06-47.06 47.06s-47.06-21.16-47.06-47.06V315.1zm47.06-188.98c-25.9.0-47.06-21.16-47.06-47.06S139 32 164.9 32s47.06 21.16 47.06 47.06v47.06H164.9zm0 23.72c25.9.0 47.06 21.16 47.06 47.06s-21.16 47.06-47.06 47.06H47.06C21.16 243.96.0 222.8.0 196.9s21.16-47.06 47.06-47.06H164.9zm188.98 47.06c0-25.9 21.16-47.06 47.06-47.06S448 171 448 196.9s-21.16 47.06-47.06 47.06h-47.06V196.9zm-23.72.0c0 25.9-21.16 47.06-47.06 47.06s-47.06-21.16-47.06-47.06V79.06c0-25.9 21.16-47.06 47.06-47.06s47.06 21.16 47.06 47.06V196.9zM283.1 385.88c25.9.0 47.06 21.16 47.06 47.06S309 480 283.1 480s-47.06-21.16-47.06-47.06v-47.06h47.06zm0-23.72c-25.9.0-47.06-21.16-47.06-47.06s21.16-47.06 47.06-47.06h117.84c25.9.0 47.06 21.16 47.06 47.06s-21.16 47.06-47.06 47.06H283.1z"/></svg></span></span><p class="text-base font-medium" title></p></a><a href=https://www.linkedin.com/groups/13033088/ class="flex items-center" target=_blank><span><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentcolor" d="M416 32H31.9C14.3 32 0 46.5.0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6.0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3.0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2.0 38.5 17.3 38.5 38.5.0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6.0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2.0 79.7 44.3 79.7 101.9V416z"/></svg></span></span><p class="text-base font-medium" title></p></a><a href=https://todo class="flex items-center" target=_blank><span><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><path fill="currentcolor" d="M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78.0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305zm-317.51 213.508V175.185l142.739 81.205-142.739 81.201z"/></svg></span></span><p class="text-base font-medium" title></p></a><a href=https://groups.google.com/g/fence-community class="flex items-center" target=_blank><span><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 488 512"><path fill="currentcolor" d="M488 261.8C488 403.3 391.1 504 248 504 110.8 504 0 393.2.0 256S110.8 8 248 8c66.8.0 123 24.5 166.3 64.9l-67.5 64.9C258.5 52.6 94.3 116.6 94.3 256c0 86.5 69.1 156.6 153.7 156.6 98.2.0 135-70.4 140.8-106.9H248v-85.3h236.1c2.3 12.7 3.9 24.9 3.9 41.4z"/></svg></span></span><p class="text-base font-medium" title></p></a></nav><div class="text-neutral-900 dark:text-neutral flex mx-auto items-center justify-between"><div class=text><p class="text-base font-medium">Made with â¤ï¸ by and for policy lovers</p><p class="text-xs text-neutral-500 dark:text-neutral-400">Powered by
<a class="hover:underline hover:decoration-primary-400 hover:text-primary-500" href=https://gohugo.io/ target=_blank rel="noopener noreferrer">Hugo</a>
&
Inspired by
<a class="hover:underline hover:decoration-primary-400 hover:text-primary-500" href=https://blowfish.page/ target=_blank rel="noopener noreferrer">Blowfish</a></p></div><nav class="hidden md:flex items-center space-x-5"><a href=https://github.com/fence-io/website class="flex items-center" target=_blank><span><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentcolor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6.0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6.0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3.0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1.0-6.2-.3-40.4-.3-61.4.0.0-70 15-84.7-29.8.0.0-11.4-29.1-27.8-36.6.0.0-22.9-15.7 1.6-15.4.0.0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5.0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9.0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4.0 33.7-.3 75.4-.3 83.6.0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6.0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9.0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg></span></span><p class="text-base font-medium" title></p></a><a href=https://twitter.com/FenceCommunity class="flex items-center" target=_blank><span><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8L200.7 275.5 26.8 48H172.4L272.9 180.9 389.2 48zM364.4 421.8h39.1L151.1 88h-42L364.4 421.8z"/></svg></span></span><p class="text-base font-medium" title></p></a><a href=https://fence-io.slack.com class="flex items-center" target=_blank><span><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentcolor" d="M94.12 315.1c0 25.9-21.16 47.06-47.06 47.06S0 341 0 315.1s21.16-47.06 47.06-47.06h47.06v47.06zm23.72.0c0-25.9 21.16-47.06 47.06-47.06s47.06 21.16 47.06 47.06v117.84c0 25.9-21.16 47.06-47.06 47.06s-47.06-21.16-47.06-47.06V315.1zm47.06-188.98c-25.9.0-47.06-21.16-47.06-47.06S139 32 164.9 32s47.06 21.16 47.06 47.06v47.06H164.9zm0 23.72c25.9.0 47.06 21.16 47.06 47.06s-21.16 47.06-47.06 47.06H47.06C21.16 243.96.0 222.8.0 196.9s21.16-47.06 47.06-47.06H164.9zm188.98 47.06c0-25.9 21.16-47.06 47.06-47.06S448 171 448 196.9s-21.16 47.06-47.06 47.06h-47.06V196.9zm-23.72.0c0 25.9-21.16 47.06-47.06 47.06s-47.06-21.16-47.06-47.06V79.06c0-25.9 21.16-47.06 47.06-47.06s47.06 21.16 47.06 47.06V196.9zM283.1 385.88c25.9.0 47.06 21.16 47.06 47.06S309 480 283.1 480s-47.06-21.16-47.06-47.06v-47.06h47.06zm0-23.72c-25.9.0-47.06-21.16-47.06-47.06s21.16-47.06 47.06-47.06h117.84c25.9.0 47.06 21.16 47.06 47.06s-21.16 47.06-47.06 47.06H283.1z"/></svg></span></span><p class="text-base font-medium" title></p></a><a href=https://www.linkedin.com/groups/13033088/ class="flex items-center" target=_blank><span><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentcolor" d="M416 32H31.9C14.3 32 0 46.5.0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6.0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3.0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2.0 38.5 17.3 38.5 38.5.0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6.0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2.0 79.7 44.3 79.7 101.9V416z"/></svg></span></span><p class="text-base font-medium" title></p></a><a href=https://todo class="flex items-center" target=_blank><span><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><path fill="currentcolor" d="M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78.0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305zm-317.51 213.508V175.185l142.739 81.205-142.739 81.201z"/></svg></span></span><p class="text-base font-medium" title></p></a><a href=https://groups.google.com/g/fence-community class="flex items-center" target=_blank><span><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 488 512"><path fill="currentcolor" d="M488 261.8C488 403.3 391.1 504 248 504 110.8 504 0 393.2.0 256S110.8 8 248 8c66.8.0 123 24.5 166.3 64.9l-67.5 64.9C258.5 52.6 94.3 116.6 94.3 256c0 86.5 69.1 156.6 153.7 156.6 98.2.0 135-70.4 140.8-106.9H248v-85.3h236.1c2.3 12.7 3.9 24.9 3.9 41.4z"/></svg></span></span><p class="text-base font-medium" title></p></a></nav></div><div id=search-wrapper class="invisible fixed inset-0 flex h-screen w-screen cursor-default flex-col bg-neutral-500/50 p-4 backdrop-blur-sm dark:bg-neutral-900/50 sm:p-6 md:p-[10vh] lg:p-[12vh]" data-url=https://fence-io.github.io/website/ style=z-index:500><div id=search-modal class="flex flex-col w-full max-w-3xl min-h-0 mx-auto border rounded-md shadow-lg top-20 border-neutral-200 bg-neutral dark:border-neutral-700 dark:bg-neutral-800"><header class="relative z-10 flex items-center justify-between flex-none px-2"><form class="flex items-center flex-auto min-w-0"><div class="flex items-center justify-center w-8 h-8 text-neutral-400"><span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg></span></div><input type=search id=search-query class="flex flex-auto h-12 mx-1 bg-transparent appearance-none focus:outline-dotted focus:outline-2 focus:outline-transparent" placeholder tabindex=0></form><button id=close-search-button class="flex items-center justify-center w-8 h-8 text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400" title></button></header><section class="flex-auto px-2 overflow-auto"><ul id=search-results></ul></section></div></div></div></div></body></html>