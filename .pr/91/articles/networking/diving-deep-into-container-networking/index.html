<!doctype html><html lang=en-us dir=ltr class=scroll-smooth data-default-appearance=dark data-auto-appearance=true><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=theme-color><link rel="shortcut icon" href=/website/.pr/91/favicon.ico><title>Diving deep into Container Networking (An Exploration of Linux Network Namespace) | Fence</title>
<meta name=image property="og:image" content="/website/.pr/91/articles/networking/diving-deep-into-container-networking/bridge.png"><style>body{font-family:roboto}</style><link href="/website/.pr/91/css/main.min.88d0ce950b0c976788afa6524b253f8087a6008924422a143184882bdd7b92fa.css" rel=stylesheet><link href="/website/.pr/91/css/schemes/slate.min.49077614e43328c746e214d8c7c3c820cdeadaf2eccb92e06d0aba4e2e102d4d.css" rel=stylesheet><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap" rel=stylesheet><script src=/website/.pr/91/js/main.23cd0c7d837263b9eaeb96ee2d9ccfa2969daa3fa00fa1c1fe8701a9b87251a1.js integrity="sha256-I80MfYNyY7nq65buLZzPopadqj+gD6HB/ocBqbhyUaE=" crossorigin=anonymous></script><script type=text/javascript src=/website/.pr/91/js/appearance.min.516a16745bea5a9bd011138d254cc0fd3973cd55ce6e15f3dec763e7c7c2c7448f8fe7b54cca811cb821b0c7e12cd161caace1dd794ac3d34d40937cbcc9ee12.js integrity="sha512-UWoWdFvqWpvQERONJUzA/TlzzVXObhXz3sdj58fCx0SPj+e1TMqBHLghsMfhLNFhyqzh3XlKw9NNQJN8vMnuEg=="></script><script src=/website/.pr/91/lib/jquery/jquery.slim.min.js integrity></script></head><body id=top class="relative flex flex-col bg-neutral text-neutral-900 dark:bg-neutral-900 dark:text-neutral"><div class="fixed top-0 bottom-0 left-0 right-0 animate-[fadeIn_1s_ease-in-out]" style=z-index:-1><img src=/website/.pr/91/img/background.svg class="w-full h-full object-cover"></div><div class="sticky top-0 bg-neutral/70 text-neutral-900 dark:bg-neutral-900/70 dark:text-neutral" style=z-index:100><div class=mx-6><div class="main-menu flex items-center justify-between"><a href=/website/.pr/91/ class="flex w-8 h-8 my-3 drop-shadow-[0_0_0.75rem_crimson]"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill="currentcolor" d="M12 3.75A6.715 6.715.0 008.278 4.868.75.75.0 117.45 3.618a8.25 8.25.0 0112.8 6.883c0 3.014-.574 5.897-1.62 8.543a.75.75.0 01-1.395-.551A21.69 21.69.0 0018.75 10.5 6.75 6.75.0 0012 3.75zM6.157 5.739a.75.75.0 01.21 1.04A6.715 6.715.0 005.25 10.5c0 1.613-.463 3.12-1.265 4.393a.75.75.0 01-1.27-.8A6.715 6.715.0 003.75 10.5c0-1.68.503-3.246 1.367-4.55a.75.75.0 011.04-.211zM12 7.5a3 3 0 00-3 3c0 3.1-1.176 5.927-3.105 8.056a.75.75.0 11-1.112-1.008A10.459 10.459.0 007.5 10.5a4.5 4.5.0 119 0c0 .547-.022 1.09-.067 1.626a.75.75.0 01-1.495-.123c.041-.495.062-.996.062-1.503a3 3 0 00-3-3zm0 2.25a.75.75.0 01.75.75c0 3.908-1.424 7.485-3.781 10.238a.75.75.0 01-1.14-.975A14.19 14.19.0 0011.25 10.5.75.75.0 0112 9.75zm3.239 5.183a.75.75.0 01.515.927 19.417 19.417.0 01-2.585 5.544.75.75.0 01-1.243-.84 17.915 17.915.0 002.386-5.116.75.75.0 01.927-.515z" clip-rule="evenodd"/></svg></a><nav class=flex-1><a href=/website/.pr/91/ class="text-xl font-bold pl-6">Fence</a></nav><nav class="hidden md:flex items-center space-x-5"><a href=/website/.pr/91/articles/ class="flex items-center"><p class="text-base font-medium" title>Articles</p></a><a href=/website/.pr/91/podcasts/ class="flex items-center"><p class="text-base font-medium" title>Podcasts</p></a><a href=/website/.pr/91/videos/ class="flex items-center"><p class="text-base font-medium" title>Videos</p></a><a href=/website/.pr/91/blog/ class="flex items-center"><p class="text-base font-medium" title>Blog</p></a><a href=/website/.pr/91/ class="flex items-center"><span><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentcolor" class="w-6 h-6"><path d="M11.47 3.841a.75.75.0 011.06.0l8.69 8.69a.75.75.0 101.06-1.061l-8.689-8.69a2.25 2.25.0 00-3.182.0l-8.69 8.69a.75.75.0 101.061 1.06l8.69-8.689z"/><path d="m12 5.432 8.159 8.159c.03.03.06.058.091.086v6.198c0 1.035-.84 1.875-1.875 1.875H15a.75.75.0 01-.75-.75v-4.5a.75.75.0 00-.75-.75h-3a.75.75.0 00-.75.75V21a.75.75.0 01-.75.75H5.625A1.875 1.875.0 013.75 19.875v-6.198a2.29 2.29.0 00.091-.086L12 5.432z"/></svg></span></span><p class="text-base font-medium" title></p></a><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentcolor" class="w-6 h-6"><path fill-rule="evenodd" d="M10.5 6a1.5 1.5.0 113 0 1.5 1.5.0 01-3 0zm0 6a1.5 1.5.0 113 0 1.5 1.5.0 01-3 0zm0 6a1.5 1.5.0 113 0 1.5 1.5.0 01-3 0z" clip-rule="evenodd"/></svg>
</span><a href=https://github.com/fence-io/website class="flex items-center" target=_blank><span><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentcolor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6.0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6.0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3.0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1.0-6.2-.3-40.4-.3-61.4.0.0-70 15-84.7-29.8.0.0-11.4-29.1-27.8-36.6.0.0-22.9-15.7 1.6-15.4.0.0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5.0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9.0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4.0 33.7-.3 75.4-.3 83.6.0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6.0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9.0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg></span></span><p class="text-base font-medium" title></p></a><a href=https://todo class="flex items-center" target=_blank><span><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8L200.7 275.5 26.8 48H172.4L272.9 180.9 389.2 48zM364.4 421.8h39.1L151.1 88h-42L364.4 421.8z"/></svg></span></span><p class="text-base font-medium" title></p></a><a href=https://todo class="flex items-center" target=_blank><span><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentcolor" d="M94.12 315.1c0 25.9-21.16 47.06-47.06 47.06S0 341 0 315.1s21.16-47.06 47.06-47.06h47.06v47.06zm23.72.0c0-25.9 21.16-47.06 47.06-47.06s47.06 21.16 47.06 47.06v117.84c0 25.9-21.16 47.06-47.06 47.06s-47.06-21.16-47.06-47.06V315.1zm47.06-188.98c-25.9.0-47.06-21.16-47.06-47.06S139 32 164.9 32s47.06 21.16 47.06 47.06v47.06H164.9zm0 23.72c25.9.0 47.06 21.16 47.06 47.06s-21.16 47.06-47.06 47.06H47.06C21.16 243.96.0 222.8.0 196.9s21.16-47.06 47.06-47.06H164.9zm188.98 47.06c0-25.9 21.16-47.06 47.06-47.06S448 171 448 196.9s-21.16 47.06-47.06 47.06h-47.06V196.9zm-23.72.0c0 25.9-21.16 47.06-47.06 47.06s-47.06-21.16-47.06-47.06V79.06c0-25.9 21.16-47.06 47.06-47.06s47.06 21.16 47.06 47.06V196.9zM283.1 385.88c25.9.0 47.06 21.16 47.06 47.06S309 480 283.1 480s-47.06-21.16-47.06-47.06v-47.06h47.06zm0-23.72c-25.9.0-47.06-21.16-47.06-47.06s21.16-47.06 47.06-47.06h117.84c25.9.0 47.06 21.16 47.06 47.06s-21.16 47.06-47.06 47.06H283.1z"/></svg></span></span><p class="text-base font-medium" title></p></a><a href=https://www.linkedin.com/groups/13033088/ class="flex items-center" target=_blank><span><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentcolor" d="M416 32H31.9C14.3 32 0 46.5.0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6.0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3.0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2.0 38.5 17.3 38.5 38.5.0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6.0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2.0 79.7 44.3 79.7 101.9V416z"/></svg></span></span><p class="text-base font-medium" title></p></a><a href=https://todo class="flex items-center" target=_blank><span><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><path fill="currentcolor" d="M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78.0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305zm-317.51 213.508V175.185l142.739 81.205-142.739 81.201z"/></svg></span></span><p class="text-base font-medium" title></p></a><a href=https://groups.google.com/g/fence-community class="flex items-center" target=_blank><span><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 488 512"><path fill="currentcolor" d="M488 261.8C488 403.3 391.1 504 248 504 110.8 504 0 393.2.0 256S110.8 8 248 8c66.8.0 123 24.5 166.3 64.9l-67.5 64.9C258.5 52.6 94.3 116.6 94.3 256c0 86.5 69.1 156.6 153.7 156.6 98.2.0 135-70.4 140.8-106.9H248v-85.3h236.1c2.3 12.7 3.9 24.9 3.9 41.4z"/></svg></span></span><p class="text-base font-medium" title></p></a><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentcolor" class="w-6 h-6"><path fill-rule="evenodd" d="M10.5 6a1.5 1.5.0 113 0 1.5 1.5.0 01-3 0zm0 6a1.5 1.5.0 113 0 1.5 1.5.0 01-3 0zm0 6a1.5 1.5.0 113 0 1.5 1.5.0 01-3 0z" clip-rule="evenodd"/></svg>
</span><button id=search-button aria-label=Search class="text-base hover:text-primary-600 dark:hover:text-primary-400" title="Search (/)">
<span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg></span></button><div class="flex items-center"><button id=appearance-switcher aria-label="Dark mode switcher" type=button class="text-base hover:text-primary-600 dark:hover:text-primary-400"><div class="flex items-center justify-center dark:hidden"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentcolor" class="w-6 h-6"><path fill-rule="evenodd" d="M9.528 1.718a.75.75.0 01.162.819A8.97 8.97.0 009 6a9 9 0 009 9 8.97 8.97.0 003.463-.69.75.75.0 01.981.98 10.503 10.503.0 01-9.694 6.46c-5.799.0-10.5-4.7-10.5-10.5.0-4.368 2.667-8.112 6.46-9.694a.75.75.0 01.818.162z" clip-rule="evenodd"/></svg></span></div><div class="items-center justify-center hidden dark:flex"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentcolor" class="w-6 h-6"><path d="M12 2.25a.75.75.0 01.75.75v2.25a.75.75.0 01-1.5.0V3a.75.75.0 01.75-.75zM7.5 12a4.5 4.5.0 119 0 4.5 4.5.0 01-9 0zM18.894 6.166a.75.75.0 00-1.06-1.06l-1.591 1.59a.75.75.0 101.06 1.061l1.591-1.59zM21.75 12a.75.75.0 01-.75.75h-2.25a.75.75.0 010-1.5H21a.75.75.0 01.75.75zm-3.916 6.894a.75.75.0 001.06-1.06l-1.59-1.591a.75.75.0 10-1.061 1.06l1.59 1.591zM12 18a.75.75.0 01.75.75V21a.75.75.0 01-1.5.0v-2.25A.75.75.0 0112 18zM7.758 17.303a.75.75.0 00-1.061-1.06l-1.591 1.59a.75.75.0 001.06 1.061l1.591-1.59zM6 12a.75.75.0 01-.75.75H3a.75.75.0 010-1.5h2.25A.75.75.0 016 12zm.697-4.243a.75.75.0 001.06-1.06l-1.59-1.591a.75.75.0 00-1.061 1.06l1.59 1.591z"/></svg></span></div></button></div></nav></div><nav class="main-menu flex md:hidden items-center justify-between space-x-2"><a href=/website/.pr/91/articles/ class="flex items-center"><p class="text-base font-medium" title>Articles</p></a><a href=/website/.pr/91/podcasts/ class="flex items-center"><p class="text-base font-medium" title>Podcasts</p></a><a href=/website/.pr/91/videos/ class="flex items-center"><p class="text-base font-medium" title>Videos</p></a><a href=/website/.pr/91/blog/ class="flex items-center"><p class="text-base font-medium" title>Blog</p></a><a href=/website/.pr/91/ class="flex items-center"><span><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentcolor" class="w-6 h-6"><path d="M11.47 3.841a.75.75.0 011.06.0l8.69 8.69a.75.75.0 101.06-1.061l-8.689-8.69a2.25 2.25.0 00-3.182.0l-8.69 8.69a.75.75.0 101.061 1.06l8.69-8.689z"/><path d="m12 5.432 8.159 8.159c.03.03.06.058.091.086v6.198c0 1.035-.84 1.875-1.875 1.875H15a.75.75.0 01-.75-.75v-4.5a.75.75.0 00-.75-.75h-3a.75.75.0 00-.75.75V21a.75.75.0 01-.75.75H5.625A1.875 1.875.0 013.75 19.875v-6.198a2.29 2.29.0 00.091-.086L12 5.432z"/></svg></span></span><p class="text-base font-medium" title></p></a><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentcolor" class="w-6 h-6"><path fill-rule="evenodd" d="M10.5 6a1.5 1.5.0 113 0 1.5 1.5.0 01-3 0zm0 6a1.5 1.5.0 113 0 1.5 1.5.0 01-3 0zm0 6a1.5 1.5.0 113 0 1.5 1.5.0 01-3 0z" clip-rule="evenodd"/></svg>
</span><button id=search-button aria-label=Search class="text-base hover:text-primary-600 dark:hover:text-primary-400" title="Search (/)">
<span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg></span></button><div class="flex items-center"><button id=appearance-switcher-mobile aria-label="Dark mode switcher" type=button class="text-base hover:text-primary-600 dark:hover:text-primary-400"><div class="flex items-center justify-center dark:hidden"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentcolor" class="w-6 h-6"><path fill-rule="evenodd" d="M9.528 1.718a.75.75.0 01.162.819A8.97 8.97.0 009 6a9 9 0 009 9 8.97 8.97.0 003.463-.69.75.75.0 01.981.98 10.503 10.503.0 01-9.694 6.46c-5.799.0-10.5-4.7-10.5-10.5.0-4.368 2.667-8.112 6.46-9.694a.75.75.0 01.818.162z" clip-rule="evenodd"/></svg></span></div><div class="items-center justify-center hidden dark:flex"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentcolor" class="w-6 h-6"><path d="M12 2.25a.75.75.0 01.75.75v2.25a.75.75.0 01-1.5.0V3a.75.75.0 01.75-.75zM7.5 12a4.5 4.5.0 119 0 4.5 4.5.0 01-9 0zM18.894 6.166a.75.75.0 00-1.06-1.06l-1.591 1.59a.75.75.0 101.06 1.061l1.591-1.59zM21.75 12a.75.75.0 01-.75.75h-2.25a.75.75.0 010-1.5H21a.75.75.0 01.75.75zm-3.916 6.894a.75.75.0 001.06-1.06l-1.59-1.591a.75.75.0 10-1.061 1.06l1.59 1.591zM12 18a.75.75.0 01.75.75V21a.75.75.0 01-1.5.0v-2.25A.75.75.0 0112 18zM7.758 17.303a.75.75.0 00-1.061-1.06l-1.591 1.59a.75.75.0 001.06 1.061l1.591-1.59zM6 12a.75.75.0 01-.75.75H3a.75.75.0 010-1.5h2.25A.75.75.0 016 12zm.697-4.243a.75.75.0 001.06-1.06l-1.59-1.591a.75.75.0 00-1.061 1.06l1.59 1.591z"/></svg></span></div></button></div></nav><script>(function(){var e=$(".main-menu");e.find(`a[href="${window.location.pathname}"]`).each(function(e,t){$(t).children("p").addClass("active")})})()</script></div></div><main id=main-content class=min-h-[calc(100vh-7rem)]><div class="bg-neutral-900 text-neutral-200 min-h-[inherit]"><div class="grid grid-cols-2 md:grid-cols-4"><div class="hidden md:block mx-8"><div class="flex flex-col sticky top-[8.4rem]"><div class="toc print:hidden"><details open><summary class="block py-1 text-lg font-semibold cursor-pointer text-neutral-100">Networking</summary><div class="border-dotted border-l pl-5 border-neutral-600">Part 1: This Article</div><div class="border-dotted border-l pl-5 border-neutral-600"><a href=https://fence-io.github.io/website/.pr/91/articles/networking/setting-up-load-balancer-service-with-cilium-in-kind-cluster/>Part 2: Setting up Load Balancer Service with Cilium in KinD Cluster</a></div></details></div></div></div><div class="col-span-2 prose prose-invert py-20 max-w-fit"><h1 class=font-normal>Diving deep into Container Networking (An Exploration of Linux Network Namespace)</h1><div class="text-sm mb-6"><div class="flex flex-row flex-wrap items-center"></div><div class="flex flex-row flex-wrap items-center"><time datetime="2024-05-09 00:00:00 +0000 UTC">May 9, 2024</time><span class="px-2 text-primary-500">&#183;</span><span>3218 words</span><span class="px-2 text-primary-500">&#183;</span><span title>16 mins</span><span class="px-2 text-primary-500">&#183;</span>
<span style=cursor:pointer>By &nbsp;
<span style=margin-top:.5rem class="mr-2 border-cyan-300" onclick='window.open("/website/.pr/91/authors/sara/","_self")'>Sara Qasmi</span></span></div><div class="flex flex-row flex-wrap items-center"><span style=margin-top:.5rem class=mr-2 onclick='window.open("/website/.pr/91/tags/networking/","_self")'><span class=flex style=cursor:pointer><span class="rounded-md border px-1 py-[1px] text-xs font-normal">Networking
</span></span></span><span style=margin-top:.5rem class=mr-2 onclick='window.open("/website/.pr/91/tags/container/","_self")'><span class=flex style=cursor:pointer><span class="rounded-md border px-1 py-[1px] text-xs font-normal">Container
</span></span></span><span style=margin-top:.5rem class=mr-2 onclick='window.open("/website/.pr/91/tags/linux/","_self")'><span class=flex style=cursor:pointer><span class="rounded-md border px-1 py-[1px] text-xs font-normal">Linux
</span></span></span><span style=margin-top:.5rem class=mr-2 onclick='window.open("/website/.pr/91/tags/bridge/","_self")'><span class=flex style=cursor:pointer><span class="rounded-md border px-1 py-[1px] text-xs font-normal">Bridge</span></span></span></div></div><h1 class="relative group font-normal">Introduction<div id=introduction class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#introduction aria-label=Anchor>#</a></span></h1><p>Container networking might seem complex and almost mystical initially, but it&rsquo;s actually built on basic Linux networking principles. By understanding these fundamentals, we can troubleshoot the container networking layers on a profound level. Furthermore, we might even create container networking solution from scratch for pure enjoyment.</p><p>In this article we are going to covere the foundational elements of container networking, from the underlying principles of network namespaces to the practical tools and techniques for managing container networking environments.</p><h1 class="relative group font-normal">Requirements<div id=requirements class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#requirements aria-label=Anchor>#</a></span></h1><ul><li>Linux host</li></ul><h1 class="relative group font-normal">Dive Into The Foundations of Container Networking<div id=dive-into-the-foundations-of-container-networking class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#dive-into-the-foundations-of-container-networking aria-label=Anchor>#</a></span></h1><p>A container is essentially, an isolated and restricted Linux process within its own networking context that is completely separate from both the host system and other containers.</p><p>At the heart of this isolation lies a fascinating Linux kernel feature known as network namespaces. According to the man page, &ldquo;network namespace is logically another copy of the network stack, with its own routes, firewall rules, and network devices.&rdquo;.</p><p>Essentially, it allows processes to operate within their own distinct network environment, including having their own network interfaces, routing tables, and firewall configurations.</p><p>This capability of Linux kernel empowers containerization technologies like Docker. By placing containers within their own network namespaces, they gain autonomy over their network configurations and ensures that containers can communicate with each other or the external network without causing interference with other containers or the host system&rsquo;s network setup (root namespace).</p><p>To unravel this concept, let&rsquo;s delve into some fundamental aspects.</p><h2 class="relative group font-normal">What is the Linux Networking Stack?<div id=what-is-the-linux-networking-stack class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#what-is-the-linux-networking-stack aria-label=Anchor>#</a></span></h2><p>The Linux networking stack is a set of software layers designed to facilitate communication across networks. Each layer within this stack is responsible for specific tasks such as data transmission, addressing, routing, and interaction with applications. Together, these layers collaborate to establish communication between devices connected to a network. This networking stack typically follows the OSI (Open Systems Interconnection) model.</p><p>Here&rsquo;s a overview of the layers commonly present in a networking stack:</p><p><img src=osi.png alt=alt></p><p>Each layer of the networking stack interacts with the layers above and below it, encapsulating data as it moves down the stack and decapsulating it as it moves up. In this article, we&rsquo;ll relay on the key components of the network stack, including:</p><ol><li><p><strong>Network Devices</strong>: Network devices, such as network interface cards (NICs), switches, and routers, are physical or virtual entities responsible for transmitting and receiving data packets on a network. These devices interface with the Linux networking stack to exchange data with other devices. You can list these devices using the command <code>ip link list</code>.</p></li><li><p><strong>Routing Table</strong>: The routing table is a critical component of the networking stack that contains information about the available routes to different network destinations. When a packet arrives at a Linux system, the networking stack consults the routing table to determine the appropriate path for forwarding the packet to its destination. Viewable with <code>ip route list</code>.</p></li><li><p><strong>iptables Rules</strong>: iptables is a powerful firewall utility in Linux that allows administrators to define rules for packet filtering and network address translation (NAT). These rules are organized into <code>chains</code> within the iptables framework.</p><p>The sequence of rules are applied to packets as they traverse the networking stack of a Linux system. These rules dictate how packets are processed, filtered, and potentially modified as they move through various stages of the networking stack.</p><p>There are three main built-in chains in iptables, each corresponding to a different stage of packet processing:</p><ul><li><strong>INPUT</strong>: Used for packets destined for the local system.</li><li><strong>FORWARD</strong>: Used for packets passing through the system.</li><li><strong>OUTPUT</strong>: Used for packets originating from the local system.</li></ul><p>When a packet reaches a chain, it is compared against the rules defined in that chain. Each rule specifies criteria that the packet must match (such as source or destination IP address, port number, protocol, etc.), as well as an action to take if the packet matches the criteria (such as accept, drop, reject, or forward to another chain).</p><p>In addition to these three built-in chains, users can also create custom chains to organize rules more efficiently or to perform specific tasks. <code>iptables --list-rules</code>.</p><p>Wait of our next article for more details on iptables.</p></li></ol><h2 class="relative group font-normal">Inspect the Network Environment<div id=inspect-the-network-environment class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#inspect-the-network-environment aria-label=Anchor>#</a></span></h2><p>Now let&rsquo;s apply what we learned before and inspect the network environment before running containers.</p><p>Network devices:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>root@ubuntu:~# ip link show 
</span></span><span style=display:flex><span>1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN mode DEFAULT group default qlen 1000
</span></span><span style=display:flex><span>    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
</span></span><span style=display:flex><span>2: enp0s1: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc fq_codel state UP mode DEFAULT group default qlen 1000
</span></span><span style=display:flex><span>    link/ether 06:c5:4b:b4:32:aa brd ff:ff:ff:ff:ff:ff
</span></span></code></pre></div><p>Routing table:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>root@ubuntu:~# ip route list 
</span></span><span style=display:flex><span>default via 192.168.64.1 dev enp0s1 proto dhcp src 192.168.64.3 metric 100 
</span></span><span style=display:flex><span>192.168.64.0/24 dev enp0s1 proto kernel scope link src 192.168.64.3 metric 100 
</span></span><span style=display:flex><span>192.168.64.1 dev enp0s1 proto dhcp scope link src 192.168.64.3 metric 100 
</span></span></code></pre></div><p>iptable rules:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>root@ubuntu:~# iptables --list-rules
</span></span><span style=display:flex><span>-P INPUT ACCEPT
</span></span><span style=display:flex><span>-P FORWARD DROP
</span></span><span style=display:flex><span>-P OUTPUT ACCEPT
</span></span><span style=display:flex><span>-N DOCKER
</span></span><span style=display:flex><span>-N DOCKER-ISOLATION-STAGE-1
</span></span><span style=display:flex><span>-N DOCKER-ISOLATION-STAGE-2
</span></span><span style=display:flex><span>-N DOCKER-USER
</span></span><span style=display:flex><span>...
</span></span></code></pre></div><p>PS: If Docker is running on your host system, you will notice some custom chains added to your iptables rules.</p><h1 class="relative group font-normal">Create Network Namespace<div id=create-network-namespace class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#create-network-namespace aria-label=Anchor>#</a></span></h1><p>Linux offers various tools and utilities for network namespace management. The <code>ip netns</code> command facilitates the creation, deletion, and administration of network namespaces.</p><p>Create a new network namespace:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>root@ubuntu:~# ip netns add app1
</span></span></code></pre></div><p>To display the network namespaces that have been created, you can use the following command:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>root@ubuntu:~# ip netns list
</span></span><span style=display:flex><span>app1
</span></span></code></pre></div><p>To execute a process within a network namespace, you can utilize the <code>netenter</code> utility. Here&rsquo;s how you can initiate a new shell within the <code>app1</code> namespace:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>root@ubuntu:~# nsenter --net=/run/netns/app1 bash
</span></span></code></pre></div><p>Now that we&rsquo;ve created a Bash process in the <code>app1</code> namespace, we can execute our commands within the network namespace.</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>root@ubuntu:~# ip link list
</span></span><span style=display:flex><span>1: lo: &lt;LOOPBACK&gt; mtu 65536 qdisc noop state DOWN mode DEFAULT group default qlen 1000
</span></span><span style=display:flex><span>    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>root@ubuntu:~# ip route list
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>root@ubuntu:~# iptables --list-rules
</span></span><span style=display:flex><span>-P INPUT ACCEPT
</span></span><span style=display:flex><span>-P FORWARD ACCEPT
</span></span><span style=display:flex><span>-P OUTPUT ACCEPT
</span></span></code></pre></div><p>This output indicates that the Bash process is operating within a fully isolated namespace (app1). There are no routing rules or custom iptables chains present, and only the loopback interface is available.</p><p><img src=network-stack.png alt=alt></p><h1 class="relative group font-normal">Network Namespace to Host connectivity<div id=network-namespace-to-host-connectivity class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#network-namespace-to-host-connectivity aria-label=Anchor>#</a></span></h1><p>Remember, network namespaces are isolated from each other and from the host. Now, let&rsquo;s establish a connection between the container&rsquo;s network namespace <code>app1</code> and the host.</p><p>To accomplish this, we&rsquo;ll use virtual Ethernet devices (veth). A veth device is a type of virtual network interface in Linux, creating a virtual network link between two network namespaces or between a network namespace and the host system.</p><p>Here&rsquo;s how it works:</p><p>A veth device is typically configured as a pair of virtual network interfaces. One end of the pair resides within the container&rsquo;s network namespace, while the other end is situated either in another network namespace or directly within the host system.</p><p>Open a new shell session to access the root network namespace:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>root@ubuntu:~# ip link add hlink1 type veth peer name clink1
</span></span><span style=display:flex><span>root@ubuntu:~# ip link list 
</span></span><span style=display:flex><span>1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN mode DEFAULT group default qlen 1000
</span></span><span style=display:flex><span>    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
</span></span><span style=display:flex><span>2: enp0s1: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc fq_codel state UP mode DEFAULT group default qlen 1000
</span></span><span style=display:flex><span>    link/ether 06:c5:4b:b4:32:aa brd ff:ff:ff:ff:ff:ff
</span></span><span style=display:flex><span>...
</span></span><span style=display:flex><span>9: clink1@hlink1: &lt;BROADCAST,MULTICAST,M-DOWN&gt; mtu 1500 qdisc noop state DOWN mode DEFAULT group default qlen 1000
</span></span><span style=display:flex><span>    link/ether a2:08:37:6f:7a:b2 brd ff:ff:ff:ff:ff:ff
</span></span><span style=display:flex><span>10: hlink1@clink1: &lt;BROADCAST,MULTICAST,M-DOWN&gt; mtu 1500 qdisc noop state DOWN mode DEFAULT group default qlen 1000
</span></span><span style=display:flex><span>    link/ether b2:2d:19:e8:a0:28 brd ff:ff:ff:ff:ff:ff
</span></span></code></pre></div><p>Both <code>hlink1</code> and <code>clink1</code> are located within the root network namespace. To establish a connection between the root network namespace and the <code>app1</code> network namespace, we must retain one of the devices <code>hlink1</code> in the root namespace while relocating the other into the <code>app1</code> namespace.</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>root@ubuntu:~# ip link set clink1 netns app1
</span></span><span style=display:flex><span>root@ubuntu:~# ip link list 
</span></span><span style=display:flex><span>1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN mode DEFAULT group default qlen 1000
</span></span><span style=display:flex><span>    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
</span></span><span style=display:flex><span>2: enp0s1: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc fq_codel state UP mode DEFAULT group default qlen 1000
</span></span><span style=display:flex><span>    link/ether 06:c5:4b:b4:32:aa brd ff:ff:ff:ff:ff:ff
</span></span><span style=display:flex><span>...
</span></span><span style=display:flex><span>10: hlink1@if9: &lt;BROADCAST,MULTICAST&gt; mtu 1500 qdisc noop state DOWN mode DEFAULT group default qlen 1000
</span></span><span style=display:flex><span>    link/ether b2:2d:19:e8:a0:28 brd ff:ff:ff:ff:ff:ff link-netns app1
</span></span></code></pre></div><p>The network device <code>clink1</code> has been relocated from the root network namespace to <code>app1</code> (notice the addition of <code>link-netns app1</code> binding to the <code>hlink1</code> device in the root network namespace). Check network devices is <code>app1</code> namespace.</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>root@ubuntu:~# nsenter --net=/run/netns/app1 ip link list
</span></span><span style=display:flex><span>1: lo: &lt;LOOPBACK&gt; mtu 65536 qdisc noop state DOWN mode DEFAULT group default qlen 1000
</span></span><span style=display:flex><span>    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
</span></span><span style=display:flex><span>9: clink1@if10: &lt;BROADCAST,MULTICAST&gt; mtu 1500 qdisc noop state DOWN mode DEFAULT group default qlen 1000
</span></span><span style=display:flex><span>    link/ether a2:08:37:6f:7a:b2 brd ff:ff:ff:ff:ff:ff link-netnsid 0
</span></span></code></pre></div><p>PS: keep in mind that both interfaces, <code>clink1</code> and <code>lo</code>, in <code>app1</code> network namespace are <code>DOWN</code>.</p><p>Now, we&rsquo;ll establish the link between both network devices, <code>hlink1</code> and <code>clink1</code> and assign appropriate IP addresses.</p><p>Stay in <code>app1</code> network namespace and run:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>nsenter --net=/run/netns/app1 bash
</span></span><span style=display:flex><span>ip link set clink1 up
</span></span><span style=display:flex><span>ip addr add 172.16.0.11/16 dev clink1
</span></span></code></pre></div><p>Check the config:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>root@ubuntu:~# ip addr show dev clink1
</span></span><span style=display:flex><span>9: clink1@if10: &lt;NO-CARRIER,BROADCAST,MULTICAST,UP&gt; mtu 1500 qdisc noqueue state LOWERLAYERDOWN group default qlen 1000
</span></span><span style=display:flex><span>    link/ether a2:08:37:6f:7a:b2 brd ff:ff:ff:ff:ff:ff link-netnsid 0
</span></span><span style=display:flex><span>    inet 172.16.0.11/16 scope global clink1
</span></span><span style=display:flex><span>       valid_lft forever preferred_lft forever
</span></span></code></pre></div><p>we need also to setup the loopback interface (It is a virtual network interface that allows communication between applications running on the same network namespace)</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>ip link set lo up 
</span></span></code></pre></div><p>Now exit <code>app1</code> and let&rsquo;s go back to the root network namespace and setup the <code>hlink1</code> interface there:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>ip link set hlink1 up
</span></span><span style=display:flex><span>ip addr add 172.16.0.10/16 dev hlink1
</span></span></code></pre></div><p>Check the config:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>root@ubuntu:~# ip addr show dev hlink1
</span></span><span style=display:flex><span>10: hlink1@if9: &lt;BROADCAST,MULTICAST&gt; mtu 1500 qdisc noop state DOWN group default qlen 1000
</span></span><span style=display:flex><span>    link/ether b2:2d:19:e8:a0:28 brd ff:ff:ff:ff:ff:ff link-netns app1
</span></span><span style=display:flex><span>    inet 172.16.0.10/16 scope global hlink1
</span></span><span style=display:flex><span>       valid_lft forever preferred_lft forever
</span></span></code></pre></div><p><img src=veth.png alt=alt></p><p>Check now routing tables in <code>app1</code> network namespaces.</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>root@ubuntu:~# nsenter --net=/run/netns/app1 ip route
</span></span><span style=display:flex><span>172.16.0.0/16 dev clink1 proto kernel scope link src 172.16.0.11
</span></span></code></pre></div><p>Then the routing table in the root network namespace.</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>root@ubuntu:~# ip route
</span></span><span style=display:flex><span>default via 192.168.64.1 dev enp0s1 proto dhcp src 192.168.64.3 metric 100 
</span></span><span style=display:flex><span>172.16.0.0/16 dev hlink1 proto kernel scope link src 172.16.0.10 
</span></span><span style=display:flex><span>192.168.64.0/24 dev enp0s1 proto kernel scope link src 192.168.64.3 metric 100 
</span></span><span style=display:flex><span>192.168.64.1 dev enp0s1 proto dhcp scope link src 192.168.64.3 metric 100 
</span></span></code></pre></div><p>In both namespaces, we observe a route connecting both interfaces, <code>hlink1</code> and <code>clink1</code>.</p><p>Let&rsquo;s start our first connectivity test by pinging <code>hlink1</code> from the <code>app1</code> network namespace.</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>root@ubuntu:~# nsenter --net=/run/netns/app1 ping 172.16.0.10
</span></span><span style=display:flex><span>PING 172.16.0.10 (172.16.0.10) 56(84) bytes of data.
</span></span><span style=display:flex><span>64 bytes from 172.16.0.10: icmp_seq=1 ttl=64 time=0.224 ms
</span></span><span style=display:flex><span>64 bytes from 172.16.0.10: icmp_seq=2 ttl=64 time=0.045 ms
</span></span></code></pre></div><p>And now, <code>clink1</code> from the root network namespace.</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>root@ubuntu:~# ping 172.16.0.11
</span></span><span style=display:flex><span>PING 172.16.0.11 (172.16.0.11) 56(84) bytes of data.
</span></span><span style=display:flex><span>64 bytes from 172.16.0.11: icmp_seq=1 ttl=64 time=0.047 ms
</span></span><span style=display:flex><span>64 bytes from 172.16.0.11: icmp_seq=2 ttl=64 time=0.060 ms
</span></span></code></pre></div><p>The connectivity test has been successful between root network namespace and <code>app1</code>.</p><h1 class="relative group font-normal">Network Namespace to Network Namespace connectivity<div id=network-namespace-to-network-namespace-connectivity class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#network-namespace-to-network-namespace-connectivity aria-label=Anchor>#</a></span></h1><p>In this section, we&rsquo;ll demonstrate that relying only on veth pairs isn&rsquo;t enough to interconnect two or more containers. This leads to conflicts in the Layer 3 (L3) routing table caused by introducing separate rules for different network namespaces. Let&rsquo;s create a second network namespace <code>app2</code> and configure the veth pair as in the <code>app1</code>:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>ip netns add app2
</span></span><span style=display:flex><span>ip link add hlink2 type veth peer name clink2
</span></span><span style=display:flex><span>ip link set hlink2 up
</span></span><span style=display:flex><span>ip addr add 172.16.0.20/16 dev hlink2
</span></span><span style=display:flex><span>ip link set clink2 netns app2
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>nsenter --net=/run/netns/app2 bash -c &#39;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    ip link set lo up
</span></span><span style=display:flex><span>    ip link set clink2 up
</span></span><span style=display:flex><span>    ip addr add 172.16.0.21/16 dev clink2
</span></span><span style=display:flex><span>    exit
</span></span><span style=display:flex><span>    &#39;
</span></span></code></pre></div><p>Now, check the routing table of the root network namespace:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>root@ubuntu:~# ip route
</span></span><span style=display:flex><span>...
</span></span><span style=display:flex><span>172.16.0.0/16 dev hlink1 proto kernel scope link src 172.16.0.10 # app1
</span></span><span style=display:flex><span>172.16.0.0/16 dev hlink2 proto kernel scope link src 172.16.0.20 # app2
</span></span><span style=display:flex><span>...
</span></span></code></pre></div><p>The root network namespace&rsquo;s routing table encountered a conflict. As you can see, after adding the second veth pair, a new route was added: <code>172.16.0.0/16 dev hlink2 proto kernel scope link src 172.16.0.20</code>. However, there was already an existing route for the <code>172.16.0.0/16</code> network. Consequently, when <code>app2</code> tries to ping the <code>hlink2</code> device, the first route is chosen, leading to connectivity issues. You can check it in the root namespace routing table:</p><p><img src=multi-ns.png alt=alt></p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>root@ubuntu:~# nsenter --net=/run/netns/app2 ping 172.16.0.20
</span></span><span style=display:flex><span>PING 172.16.0.20 (172.16.0.20) 56(84) bytes of data.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>--- 172.16.0.20 ping statistics ---
</span></span><span style=display:flex><span>2 packets transmitted, 0 received, 100% packet loss, time 1023ms
</span></span></code></pre></div><p>The connectivity test confirms that we are unable to access <code>hlink2</code> from <code>app2</code>, despite having a rule in the routing table of the <code>app2</code> namespace: <code>172.16.0.0/16 dev clink2 proto kernel scope link src 172.16.0.21</code> (Another way to confirm this is by utilizing tcpdump on the <code>hlink2</code> interface within the root network namespace. Executing the command <code>tcpdump -i hlink2 icmp</code> will capture all ICMP paquets passing through the <code>hlink2</code> interface.)</p><h2 class="relative group font-normal">Linux Bridge<div id=linux-bridge class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#linux-bridge aria-label=Anchor>#</a></span></h2><p>The previous issue pushed us to explore alternatives for interconnecting containers, leading us to the Linux feature known as Linux Bridge. Operating similarly to a network switch, a Linux bridge facilitates packet forwarding between connected interfaces at the L2 level. (Please check <a href=https://fence-io.github.io/website/articles/networking/load-balancer-cilium-kind>Setting up Load Balancer Service with Cilium in KinD Cluster</a> for more details on l2 connectivity)</p><p>In the container ecosystem, the bridge acts as a virtual networking interface, linking containers through virtual Ethernet pairs. Each container is equipped with its own veth pair, with one end attached to the bridge network. This setup facilitates internal communication between containers and with the host system.</p><p><img src=bridge-network.png alt=alt></p><p>Let&rsquo;s create new namespaces. Go to the root network namespace.</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>ip netns add app3
</span></span><span style=display:flex><span>ip link add hlink3 type veth peer name clink3
</span></span><span style=display:flex><span>ip link set hlink3 up
</span></span><span style=display:flex><span>ip link set clink3 netns app3
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>nsenter --net=/run/netns/app3 bash
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>ip link set lo up
</span></span><span style=display:flex><span>ip link set clink3 up
</span></span><span style=display:flex><span>ip addr add 172.16.0.30/16 dev clink3
</span></span><span style=display:flex><span>ip link
</span></span></code></pre></div><p>Exit <code>app3</code> network namespace.</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>exit
</span></span></code></pre></div><p>Create <code>app4</code> network namespace.</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>ip netns add app4
</span></span><span style=display:flex><span>ip link add hlink4 type veth peer name clink4
</span></span><span style=display:flex><span>ip link set hlink4 up
</span></span><span style=display:flex><span>ip link set clink4 netns app4
</span></span><span style=display:flex><span>ip link
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>nsenter --net=/run/netns/app4 bash
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>ip link set lo up
</span></span><span style=display:flex><span>ip link set clink4 up
</span></span><span style=display:flex><span>ip addr add 172.16.0.40/16 dev clink4
</span></span><span style=display:flex><span>ip link
</span></span></code></pre></div><p>Exit <code>app4</code> namespace.</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>exit
</span></span></code></pre></div><p>Make sure that there is no new routes added to the routing table of the root namespace:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>root@ubuntu:~# ip route 
</span></span><span style=display:flex><span>default via 192.168.64.1 dev enp0s1 proto dhcp src 192.168.64.3 metric 100 
</span></span><span style=display:flex><span>192.168.64.0/24 dev enp0s1 proto kernel scope link src 192.168.64.3 metric 100 
</span></span><span style=display:flex><span>192.168.64.1 dev enp0s1 proto dhcp scope link src 192.168.64.3 metric 100 
</span></span></code></pre></div><p>Now, let&rsquo;s create the bridge device and connect <code>hlink3</code> and <code>hlink4</code> to it to ensure connectivity between the containers. Go to the root network namespace.</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>ip link add br0 type bridge 
</span></span><span style=display:flex><span>ip link set br0 up
</span></span><span style=display:flex><span>ip link set hlink3 master br0
</span></span><span style=display:flex><span>ip link set hlink4 master br0
</span></span><span style=display:flex><span>ip link
</span></span></code></pre></div><p><img src=ns-via-bridge.png alt=alt></p><h2 class="relative group font-normal">Connectivity Test<div id=connectivity-test class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#connectivity-test aria-label=Anchor>#</a></span></h2><p>PS: If you are running docker in your host, make sure to remove br_netfilter kernel module <code>rmmod br_netfilter</code> (for more details <a href=https://unix.stackexchange.com/questions/671644/cant-establish-communication-between-two-network-namespaces-using-bridge-networ>https://unix.stackexchange.com/questions/671644/cant-establish-communication-between-two-network-namespaces-using-bridge-networ</a>)</p><p>Before the ping test, ensure to run tcpdump on the bridge interface to capture the ICMP traffic between both containers.</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>tcpdump -i br0 icmp
</span></span></code></pre></div><p>Now, switch to another session and execute the following commands:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>root@ubuntu:~# nsenter --net=/run/netns/app3 ping -c 2 172.16.0.40
</span></span><span style=display:flex><span>PING 172.16.0.40 (172.16.0.40) 56(84) bytes of data.
</span></span><span style=display:flex><span>64 bytes from 172.16.0.40: icmp_seq=1 ttl=64 time=0.142 ms
</span></span><span style=display:flex><span>64 bytes from 172.16.0.40: icmp_seq=2 ttl=64 time=0.071 ms
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>--- 172.16.0.40 ping statistics ---
</span></span><span style=display:flex><span>2 packets transmitted, 2 received, 0% packet loss, time 1025ms
</span></span><span style=display:flex><span>rtt min/avg/max/mdev = 0.071/0.106/0.142/0.035 ms
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>root@ubuntu:~# nsenter --net=/run/netns/app4 ping -c 2 172.16.0.30
</span></span><span style=display:flex><span>PING 172.16.0.30 (172.16.0.30) 56(84) bytes of data.
</span></span><span style=display:flex><span>64 bytes from 172.16.0.30: icmp_seq=1 ttl=64 time=0.053 ms
</span></span><span style=display:flex><span>64 bytes from 172.16.0.30: icmp_seq=2 ttl=64 time=0.057 ms
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>--- 172.16.0.30 ping statistics ---
</span></span><span style=display:flex><span>2 packets transmitted, 2 received, 0% packet loss, time 1028ms
</span></span><span style=display:flex><span>rtt min/avg/max/mdev = 0.053/0.055/0.057/0.002 ms
</span></span></code></pre></div><p>We can see from the tcpdum command that the icmp traffic if going through brigde to reach each destination network namespace.</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>root@ubuntu:~# tcpdump -i br0 icmp
</span></span><span style=display:flex><span>tcpdump: verbose output suppressed, use -v[v]... for full protocol decode
</span></span><span style=display:flex><span>listening on br0, link-type EN10MB (Ethernet), snapshot length 262144 bytes
</span></span><span style=display:flex><span>16:19:13.037613 IP 172.16.0.30 &gt; 172.16.0.40: ICMP echo request, id 44793, seq 1, length 64
</span></span><span style=display:flex><span>16:19:13.037626 IP 172.16.0.40 &gt; 172.16.0.30: ICMP echo reply, id 44793, seq 1, length 64
</span></span><span style=display:flex><span>16:19:14.062746 IP 172.16.0.30 &gt; 172.16.0.40: ICMP echo request, id 44793, seq 2, length 64
</span></span><span style=display:flex><span>16:19:14.062781 IP 172.16.0.40 &gt; 172.16.0.30: ICMP echo reply, id 44793, seq 2, length 64
</span></span><span style=display:flex><span>16:19:42.217807 IP 172.16.0.40 &gt; 172.16.0.30: ICMP echo request, id 13480, seq 1, length 64
</span></span><span style=display:flex><span>16:19:42.217839 IP 172.16.0.30 &gt; 172.16.0.40: ICMP echo reply, id 13480, seq 1, length 64
</span></span><span style=display:flex><span>16:19:43.245866 IP 172.16.0.40 &gt; 172.16.0.30: ICMP echo request, id 13480, seq 2, length 64
</span></span><span style=display:flex><span>16:19:43.245894 IP 172.16.0.30 &gt; 172.16.0.40: ICMP echo reply, id 13480, seq 2, length 64
</span></span></code></pre></div><p>The test is successful !! Without configuring hlink3 and hlink4, we assigned IP addresses only to clink3 and clink4. Since they&rsquo;re on the same Ethernet segment (connected to the bridge) L2 connectivity is established. We can verify this also by checking the ARP table in both namespaces for the MAC addresses of each other.</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>root@ubuntu:~# nsenter --net=/run/netns/app3 arp -n
</span></span><span style=display:flex><span>Address                  HWtype  HWaddress           Flags Mask            Iface
</span></span><span style=display:flex><span>172.16.0.40              ether   52:45:d1:3a:b3:32   C                     clink3
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>root@ubuntu:~# nsenter --net=/run/netns/app4 arp -n
</span></span><span style=display:flex><span>Address                  HWtype  HWaddress           Flags Mask            Iface
</span></span><span style=display:flex><span>172.16.0.30              ether   82:6e:c9:b4:c0:79   C                     clink4
</span></span></code></pre></div><p>Also you can run.</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>root@ubuntu:~# nsenter --net=/run/netns/app3 ip neigh
</span></span><span style=display:flex><span>172.16.0.40 dev clink3 lladdr 52:45:d1:3a:b3:32 REACHABLE
</span></span></code></pre></div><p>This command shows that the IP address 172.16.0.40 (app4) is reachable via the device <code>clink3</code> in the network namespace <code>app3</code>, with MAC address 52:45:d1:3a:b3:32.</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>root@ubuntu:~# nsenter --net=/run/netns/app4 ip neigh
</span></span><span style=display:flex><span>172.16.0.30 dev clink4 lladdr 82:6e:c9:b4:c0:79 REACHABLE
</span></span></code></pre></div><p>Let&rsquo;s try to ping <code>app3</code> from the root network namespace.</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>root@ubuntu:~# ping -c 2 172.16.0.30
</span></span><span style=display:flex><span>PING 172.16.0.30 (172.16.0.30) 56(84) bytes of data.
</span></span><span style=display:flex><span>From 172.16.0.10 icmp_seq=1 Destination Host Unreachable
</span></span><span style=display:flex><span>From 172.16.0.10 icmp_seq=2 Destination Host Unreachable
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>--- 172.16.0.30 ping statistics ---
</span></span><span style=display:flex><span>2 packets transmitted, 0 received, +2 errors, 100% packet loss, time 1017ms
</span></span></code></pre></div><p>The root namespace cannot talk to containers. To establish the connectivity between the root and container namespaces, we need to assign the IP address to the bridge network interface.</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>ip addr add 172.16.0.1/16 dev br0
</span></span></code></pre></div><p>Once we assigned ip address to br0 we got a route in the host routing table: <code>172.16.0.0/16 dev br0 proto kernel scope link src 172.16.0.1</code></p><p>Now we should be able to ping containers from the root network namespace.</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>root@ubuntu:~# ping -c 2 172.16.0.30
</span></span><span style=display:flex><span>PING 172.16.0.30 (172.16.0.30) 56(84) bytes of data.
</span></span><span style=display:flex><span>64 bytes from 172.16.0.30: icmp_seq=1 ttl=64 time=0.085 ms
</span></span><span style=display:flex><span>64 bytes from 172.16.0.30: icmp_seq=2 ttl=64 time=0.069 ms
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>--- 172.16.0.30 ping statistics ---
</span></span><span style=display:flex><span>2 packets transmitted, 2 received, 0% packet loss, time 1016ms
</span></span><span style=display:flex><span>rtt min/avg/max/mdev = 0.069/0.077/0.085/0.008 ms
</span></span></code></pre></div><p>In the container&rsquo;s side we should add a default route to the bridge interface.</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>root@ubuntu:~# nsenter --net=/run/netns/app3  ip route add default via 172.16.0.1
</span></span><span style=display:flex><span>root@ubuntu:~# nsenter --net=/run/netns/app4  ip route add default via 172.16.0.1
</span></span></code></pre></div><p>Now, <code>app3</code> and <code>app4</code> can reach any network interfaces in the root network namespace.</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>root@ubuntu:~# nsenter --net=/run/netns/app3  ping -c 2 192.168.64.3
</span></span><span style=display:flex><span>PING 192.168.64.3 (192.168.64.3) 56(84) bytes of data.
</span></span><span style=display:flex><span>64 bytes from 192.168.64.3: icmp_seq=1 ttl=64 time=0.184 ms
</span></span><span style=display:flex><span>64 bytes from 192.168.64.3: icmp_seq=2 ttl=64 time=0.066 ms
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>--- 192.168.64.3 ping statistics ---
</span></span><span style=display:flex><span>2 packets transmitted, 2 received, 0% packet loss, time 1019ms
</span></span><span style=display:flex><span>rtt min/avg/max/mdev = 0.066/0.125/0.184/0.059 ms
</span></span></code></pre></div><p>Great! We can go from the containers to the host and back.</p><h1 class="relative group font-normal">Conclusion<div id=conclusion class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#conclusion aria-label=Anchor>#</a></span></h1><p>Understanding Linux networking features is fundamental to many containerization technologies. This foundational knowledge serves as a basis for comprehending higher-level networking concepts used in Kubernetes. In our upcoming article, we&rsquo;ll explore how Container Runtime Interface (CRI) and Container Network Interface (CNI) leverage these features within the Kubernetes ecosystem.</p></div><div class="hidden md:block mx-8"><div class="flex flex-col sticky top-[8.4rem]"><div class="toc print:hidden"><details open class="toc-right mt-0 overflow-hidden"><summary class="block py-1 text-lg font-semibold cursor-pointer text-neutral-100">Table of Contents</summary><div class="py-1 border-dotted border-l pl-5 border-neutral-600"><nav id=TableOfContents><ul><li><a href=#introduction>Introduction</a></li><li><a href=#requirements>Requirements</a></li><li><a href=#dive-into-the-foundations-of-container-networking>Dive Into The Foundations of Container Networking</a><ul><li><a href=#what-is-the-linux-networking-stack>What is the Linux Networking Stack?</a></li><li><a href=#inspect-the-network-environment>Inspect the Network Environment</a></li></ul></li><li><a href=#create-network-namespace>Create Network Namespace</a></li><li><a href=#network-namespace-to-host-connectivity>Network Namespace to Host connectivity</a></li><li><a href=#network-namespace-to-network-namespace-connectivity>Network Namespace to Network Namespace connectivity</a><ul><li><a href=#linux-bridge>Linux Bridge</a></li><li><a href=#connectivity-test>Connectivity Test</a></li></ul></li><li><a href=#conclusion>Conclusion</a></li></ul></nav></div></details><script>(function(){var t,e=$("#TableOfContents");if(console.log(e),e.length>0){t=$(window);function n(){var n,i=t.scrollTop(),o=$(".anchor"),s="";if(console.log(o),o.each(function(e,t){t=$(t),t.offset().top-$(window).height()/3<=i&&(s=t.attr("id"))}),n=e.find("a.active"),n.length==1&&n.eq(0).attr("href")=="#"+s)return!0;n.each(function(e,t){$(t).removeClass("active")}),e.find('a[href="#'+s+'"]').addClass("active")}t.on("scroll",n)}})()</script></div><a href=https://codespaces.new/fence-io/playground target=_blank class=mt-5><img src=https://github.com/codespaces/badge.svg alt='Open in GitHub Codespaces' style=max-width:100%></a></div><div class="absolute top-[110vh] bottom-[4rem] w-12 mx-auto overflow-y-clip"><div class="sticky top-[calc(100vh-5rem)] pb-1 flex items-center justify-center space-x-7"><a href=#top class="p-2 w-12 h-12 ring-1 ring-slate-900/5 dark:ring-slate-200/20 shadow-lg rounded-full text-base hover:text-primary-600 dark:hover:text-primary-400"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentcolor"><path stroke-linecap="round" stroke-linejoin="round" d="M4.5 10.5 12 3m0 0 7.5 7.5M12 3v18"/></svg></a></div></div></div></div></div></main><div class="bg-neutral/70 text-neutral-900 dark:bg-neutral-900/70 dark:text-neutral"><div class="mx-6 my-2"><nav class="flex md:hidden items-center justify-between space-x-2 mb-2"><a href=https://github.com/fence-io/website class="flex items-center" target=_blank><span><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentcolor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6.0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6.0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3.0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1.0-6.2-.3-40.4-.3-61.4.0.0-70 15-84.7-29.8.0.0-11.4-29.1-27.8-36.6.0.0-22.9-15.7 1.6-15.4.0.0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5.0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9.0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4.0 33.7-.3 75.4-.3 83.6.0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6.0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9.0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg></span></span><p class="text-base font-medium" title></p></a><a href=https://todo class="flex items-center" target=_blank><span><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8L200.7 275.5 26.8 48H172.4L272.9 180.9 389.2 48zM364.4 421.8h39.1L151.1 88h-42L364.4 421.8z"/></svg></span></span><p class="text-base font-medium" title></p></a><a href=https://todo class="flex items-center" target=_blank><span><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentcolor" d="M94.12 315.1c0 25.9-21.16 47.06-47.06 47.06S0 341 0 315.1s21.16-47.06 47.06-47.06h47.06v47.06zm23.72.0c0-25.9 21.16-47.06 47.06-47.06s47.06 21.16 47.06 47.06v117.84c0 25.9-21.16 47.06-47.06 47.06s-47.06-21.16-47.06-47.06V315.1zm47.06-188.98c-25.9.0-47.06-21.16-47.06-47.06S139 32 164.9 32s47.06 21.16 47.06 47.06v47.06H164.9zm0 23.72c25.9.0 47.06 21.16 47.06 47.06s-21.16 47.06-47.06 47.06H47.06C21.16 243.96.0 222.8.0 196.9s21.16-47.06 47.06-47.06H164.9zm188.98 47.06c0-25.9 21.16-47.06 47.06-47.06S448 171 448 196.9s-21.16 47.06-47.06 47.06h-47.06V196.9zm-23.72.0c0 25.9-21.16 47.06-47.06 47.06s-47.06-21.16-47.06-47.06V79.06c0-25.9 21.16-47.06 47.06-47.06s47.06 21.16 47.06 47.06V196.9zM283.1 385.88c25.9.0 47.06 21.16 47.06 47.06S309 480 283.1 480s-47.06-21.16-47.06-47.06v-47.06h47.06zm0-23.72c-25.9.0-47.06-21.16-47.06-47.06s21.16-47.06 47.06-47.06h117.84c25.9.0 47.06 21.16 47.06 47.06s-21.16 47.06-47.06 47.06H283.1z"/></svg></span></span><p class="text-base font-medium" title></p></a><a href=https://www.linkedin.com/groups/13033088/ class="flex items-center" target=_blank><span><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentcolor" d="M416 32H31.9C14.3 32 0 46.5.0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6.0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3.0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2.0 38.5 17.3 38.5 38.5.0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6.0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2.0 79.7 44.3 79.7 101.9V416z"/></svg></span></span><p class="text-base font-medium" title></p></a><a href=https://todo class="flex items-center" target=_blank><span><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><path fill="currentcolor" d="M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78.0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305zm-317.51 213.508V175.185l142.739 81.205-142.739 81.201z"/></svg></span></span><p class="text-base font-medium" title></p></a><a href=https://groups.google.com/g/fence-community class="flex items-center" target=_blank><span><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 488 512"><path fill="currentcolor" d="M488 261.8C488 403.3 391.1 504 248 504 110.8 504 0 393.2.0 256S110.8 8 248 8c66.8.0 123 24.5 166.3 64.9l-67.5 64.9C258.5 52.6 94.3 116.6 94.3 256c0 86.5 69.1 156.6 153.7 156.6 98.2.0 135-70.4 140.8-106.9H248v-85.3h236.1c2.3 12.7 3.9 24.9 3.9 41.4z"/></svg></span></span><p class="text-base font-medium" title></p></a></nav><div class="text-neutral-900 dark:text-neutral flex mx-auto items-center justify-between"><div class=text><p class="text-base font-medium">Made with ❤️ by and for policy lovers</p><p class="text-xs text-neutral-500 dark:text-neutral-400">Powered by
<a class="hover:underline hover:decoration-primary-400 hover:text-primary-500" href=https://gohugo.io/ target=_blank rel="noopener noreferrer">Hugo</a>
&
Inspired by
<a class="hover:underline hover:decoration-primary-400 hover:text-primary-500" href=https://blowfish.page/ target=_blank rel="noopener noreferrer">Blowfish</a></p></div><nav class="hidden md:flex items-center space-x-5"><a href=https://github.com/fence-io/website class="flex items-center" target=_blank><span><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentcolor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6.0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6.0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3.0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1.0-6.2-.3-40.4-.3-61.4.0.0-70 15-84.7-29.8.0.0-11.4-29.1-27.8-36.6.0.0-22.9-15.7 1.6-15.4.0.0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5.0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9.0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4.0 33.7-.3 75.4-.3 83.6.0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6.0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9.0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg></span></span><p class="text-base font-medium" title></p></a><a href=https://todo class="flex items-center" target=_blank><span><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8L200.7 275.5 26.8 48H172.4L272.9 180.9 389.2 48zM364.4 421.8h39.1L151.1 88h-42L364.4 421.8z"/></svg></span></span><p class="text-base font-medium" title></p></a><a href=https://todo class="flex items-center" target=_blank><span><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentcolor" d="M94.12 315.1c0 25.9-21.16 47.06-47.06 47.06S0 341 0 315.1s21.16-47.06 47.06-47.06h47.06v47.06zm23.72.0c0-25.9 21.16-47.06 47.06-47.06s47.06 21.16 47.06 47.06v117.84c0 25.9-21.16 47.06-47.06 47.06s-47.06-21.16-47.06-47.06V315.1zm47.06-188.98c-25.9.0-47.06-21.16-47.06-47.06S139 32 164.9 32s47.06 21.16 47.06 47.06v47.06H164.9zm0 23.72c25.9.0 47.06 21.16 47.06 47.06s-21.16 47.06-47.06 47.06H47.06C21.16 243.96.0 222.8.0 196.9s21.16-47.06 47.06-47.06H164.9zm188.98 47.06c0-25.9 21.16-47.06 47.06-47.06S448 171 448 196.9s-21.16 47.06-47.06 47.06h-47.06V196.9zm-23.72.0c0 25.9-21.16 47.06-47.06 47.06s-47.06-21.16-47.06-47.06V79.06c0-25.9 21.16-47.06 47.06-47.06s47.06 21.16 47.06 47.06V196.9zM283.1 385.88c25.9.0 47.06 21.16 47.06 47.06S309 480 283.1 480s-47.06-21.16-47.06-47.06v-47.06h47.06zm0-23.72c-25.9.0-47.06-21.16-47.06-47.06s21.16-47.06 47.06-47.06h117.84c25.9.0 47.06 21.16 47.06 47.06s-21.16 47.06-47.06 47.06H283.1z"/></svg></span></span><p class="text-base font-medium" title></p></a><a href=https://www.linkedin.com/groups/13033088/ class="flex items-center" target=_blank><span><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentcolor" d="M416 32H31.9C14.3 32 0 46.5.0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6.0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3.0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2.0 38.5 17.3 38.5 38.5.0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6.0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2.0 79.7 44.3 79.7 101.9V416z"/></svg></span></span><p class="text-base font-medium" title></p></a><a href=https://todo class="flex items-center" target=_blank><span><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><path fill="currentcolor" d="M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78.0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305zm-317.51 213.508V175.185l142.739 81.205-142.739 81.201z"/></svg></span></span><p class="text-base font-medium" title></p></a><a href=https://groups.google.com/g/fence-community class="flex items-center" target=_blank><span><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 488 512"><path fill="currentcolor" d="M488 261.8C488 403.3 391.1 504 248 504 110.8 504 0 393.2.0 256S110.8 8 248 8c66.8.0 123 24.5 166.3 64.9l-67.5 64.9C258.5 52.6 94.3 116.6 94.3 256c0 86.5 69.1 156.6 153.7 156.6 98.2.0 135-70.4 140.8-106.9H248v-85.3h236.1c2.3 12.7 3.9 24.9 3.9 41.4z"/></svg></span></span><p class="text-base font-medium" title></p></a></nav></div><div id=search-wrapper class="invisible fixed inset-0 flex h-screen w-screen cursor-default flex-col bg-neutral-500/50 p-4 backdrop-blur-sm dark:bg-neutral-900/50 sm:p-6 md:p-[10vh] lg:p-[12vh]" data-url=https://fence-io.github.io/website/.pr/91/ style=z-index:500><div id=search-modal class="flex flex-col w-full max-w-3xl min-h-0 mx-auto border rounded-md shadow-lg top-20 border-neutral-200 bg-neutral dark:border-neutral-700 dark:bg-neutral-800"><header class="relative z-10 flex items-center justify-between flex-none px-2"><form class="flex items-center flex-auto min-w-0"><div class="flex items-center justify-center w-8 h-8 text-neutral-400"><span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg></span></div><input type=search id=search-query class="flex flex-auto h-12 mx-1 bg-transparent appearance-none focus:outline-dotted focus:outline-2 focus:outline-transparent" placeholder tabindex=0></form><button id=close-search-button class="flex items-center justify-center w-8 h-8 text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400" title></button></header><section class="flex-auto px-2 overflow-auto"><ul id=search-results></ul></section></div></div></div></div></body></html>